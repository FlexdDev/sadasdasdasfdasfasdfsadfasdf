<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ebfl.ai - Yapay Zeka Eğitim Asistanı</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script>
  // API URL'sini burada tanımlayın - server.js'in çalıştığı adres
  const API_URL = 'http://178.208.187.246:3000';
</script>
<style>
  /* ===== VARIABLES ===== */
  :root {
    --primary: #818cf8;
    --primary-dark: #6366f1;
    --secondary: #ec4899;
    --light-bg: #f9fafb;
    --light-text: #1f2937;
    --light-border: #e5e7eb;
    --light-hover: #f0f4ff;
    --dark-bg: #1f2937;
    --dark-secondary: #374151;
    --dark-text: #f3f4f6;
    --dark-border: #4b5563;
    --dark-hover: #2d3748;
    --success: #10b981;
    --warning: #f59e0b;
    --danger: #ef4444;
    --transition-normal: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
    --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
    --radius: 0.75rem;
  }

  [data-theme="dark"] {
    --primary: #818cf8;
    --primary-dark: #6366f1;
  }

  /* ===== BASE STYLES ===== */
  * { 
    margin: 0; 
    padding: 0; 
    box-sizing: border-box; 
    transition: var(--transition-normal);
  }

  body {
    font-family: 'Segoe UI', 'Poppins', sans-serif;
    background: var(--light-bg);
    display: flex;
    height: 100vh;
    color: var(--light-text);
    overflow: hidden;
  }

  body[data-theme="dark"] {
    background: var(--dark-bg);
    color: var(--dark-text);
  }

  /* ===== SIDEBAR STYLES ===== */
  .sidebar {
    width: 280px;
    background: #fff;
    border-right: 1px solid var(--light-border);
    display: flex;
    flex-direction: column;
    padding: 25px 15px;
    box-shadow: var(--shadow-sm);
    overflow-y: auto;
    z-index: 10;
    transition: transform 0.3s ease;
  }

  body[data-theme="dark"] .sidebar {
    background: var(--dark-secondary);
    border-right: 1px solid var(--dark-border);
  }

  .sidebar h1 {
    font-size: 24px;
    font-weight: bold;
    margin-bottom: 35px;
    color: var(--primary);
    text-align: center;
    transition: color 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
  }

  .sidebar h1 i {
    font-size: 20px;
  }

  .user-profile {
    display: flex;
    align-items: center;
    margin-bottom: 30px;
    padding: 12px;
    background: var(--light-hover);
    border-radius: 12px;
  }

  body[data-theme="dark"] .user-profile {
    background: var(--dark-hover);
  }

  .avatar {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: var(--primary);
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: bold;
    margin-right: 12px;
  }

  .user-info {
    flex: 1;
  }

  .user-info .name {
    font-weight: bold;
    font-size: 14px;
    margin-bottom: 2px;
  }

  .user-info .role {
    font-size: 12px;
    color: #666;
  }

  body[data-theme="dark"] .user-info .role {
    color: #aaa;
  }

  .menu-button {
    background: none;
    border: none;
    text-align: left;
    padding: 14px;
    border-radius: 12px;
    font-size: 15px;
    margin-bottom: 8px;
    cursor: pointer;
    transition: background 0.2s ease;
    display: flex;
    align-items: center;
    gap: 12px;
    font-weight: 500;
    color: var(--light-text);
    width: 100%;
  }

  body[data-theme="dark"] .menu-button {
    color: var(--dark-text);
  }

  .menu-button:hover {
    background: var(--light-hover);
  }

  body[data-theme="dark"] .menu-button:hover {
    background: var(--dark-hover);
  }

  .menu-button.active {
    background: var(--primary);
    color: white;
  }

  .menu-button.active:hover {
    background: var(--primary-dark);
  }

  .menu-button i {
    font-size: 18px;
    width: 24px;
    text-align: center;
  }

  .chat-history {
    margin-top: 30px;
  }

  .chat-history h3 {
    font-size: 14px;
    font-weight: 600;
    color: #666;
    margin-bottom: 12px;
    padding: 0 12px;
  }

  body[data-theme="dark"] .chat-history h3 {
    color: #aaa;
  }

  .chat-item {
    background: #f8f8f8;
    border-radius: 12px;
    padding: 14px;
    margin-bottom: 10px;
    font-size: 14px;
    cursor: pointer;
    transition: all 0.2s ease;
    display: flex;
    align-items: center;
    gap: 10px;
  }

  body[data-theme="dark"] .chat-item {
    background: var(--dark-hover);
  }

  .chat-item:hover {
    background: #e6e6e6;
    transform: translateY(-2px);
  }

  body[data-theme="dark"] .chat-item:hover {
    background: #2d3748;
  }

  .chat-item i {
    color: var(--primary);
    font-size: 16px;
  }

  .theme-toggle {
    margin-top: auto;
    display: flex;
    justify-content: center;
    padding: 15px 0;
  }

  .theme-toggle button {
    background: none;
    border: none;
    font-size: 20px;
    color: #666;
    cursor: pointer;
    padding: 8px;
    border-radius: 50%;
    transition: all 0.2s ease;
  }

  body[data-theme="dark"] .theme-toggle button {
    color: #aaa;
  }

  .theme-toggle button:hover {
    background: var(--light-hover);
    color: var(--primary);
  }

  body[data-theme="dark"] .theme-toggle button:hover {
    background: var(--dark-hover);
    color: var(--primary);
  }

  /* ===== MAIN CONTENT STYLES ===== */
  .chat-main {
    flex: 1;
    display: flex;
    flex-direction: column;
    overflow: hidden;
  }

  .header-bar {
    padding: 15px 25px;
    border-bottom: 1px solid var(--light-border);
    background: #fff;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: var(--shadow-sm);
  }

  body[data-theme="dark"] .header-bar {
    background: var(--dark-secondary);
    border-bottom: 1px solid var(--dark-border);
  }

  .header-bar .title {
    font-size: 18px;
    font-weight: bold;
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .header-bar .title i {
    color: var(--primary);
  }

  .auth-buttons {
    display: flex;
    gap: 10px;
  }

  .auth-buttons button {
    background: transparent;
    border: 1px solid var(--primary);
    padding: 8px 16px;
    border-radius: 8px;
    color: var(--primary);
    cursor: pointer;
    font-size: 14px;
    font-weight: 500;
    transition: all 0.2s ease;
  }

  .auth-buttons button:hover {
    background: var(--primary);
    color: white;
  }

  .auth-buttons button:last-child {
    background: var(--primary);
    color: white;
  }

  .auth-buttons button:last-child:hover {
    background: var(--primary-dark);
  }

  /* ===== TAB CONTENT STYLES ===== */
  .tab-content {
    display: none;
    padding: 25px;
    overflow-y: auto;
    flex: 1;
  }

  .tab-content.active {
    display: flex;
    flex-direction: column;
  }

  /* ===== CHATBOT TAB STYLES ===== */
  .chat-body {
    flex: 1;
    padding: 25px;
    background: var(--light-bg);
    overflow-y: auto;
    display: flex;
    flex-direction: column;
    gap: 20px;
  }

  body[data-theme="dark"] .chat-body {
    background: var(--dark-bg);
  }

  .message {
    max-width: 70%;
    padding: 16px 20px;
    border-radius: 18px;
    font-size: 15px;
    box-shadow: var(--shadow-sm);
    animation: fadeInUp 0.4s ease-out;
    position: relative;
    line-height: 1.5;
  }

  .message.user {
    align-self: flex-end;
    background-color: var(--primary);
    color: white;
    border-bottom-right-radius: 4px;
  }

  .message.assistant {
    align-self: flex-start;
    background-color: white;
    color: var(--light-text);
    border-bottom-left-radius: 4px;
  }

  body[data-theme="dark"] .message.assistant {
    background-color: var(--dark-secondary);
    color: var(--dark-text);
  }

  .message-actions {
    position: absolute;
    right: 10px;
    bottom: -28px;
    display: flex;
    gap: 8px;
  }

  .message-action {
    font-size: 12px;
    background: #fff;
    color: var(--primary);
    border: 1px solid var(--primary);
    padding: 4px 10px;
    border-radius: 20px;
    cursor: pointer;
    transition: all 0.2s ease;
    display: flex;
    align-items: center;
    gap: 5px;
  }

  body[data-theme="dark"] .message-action {
    background: var(--dark-secondary);
  }

  .message-action:hover {
    background: var(--primary);
    color: #fff;
  }

  .message-action i {
    font-size: 10px;
  }

  @keyframes fadeInUp {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .suggestions {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    margin-top: 20px;
    margin-bottom: 5px;
  }

  .suggestion-chip {
    background: white;
    border: 1px solid var(--light-border);
    padding: 8px 15px;
    border-radius: 20px;
    font-size: 13px;
    cursor: pointer;
    transition: all 0.2s ease;
    color: var(--light-text);
  }

  body[data-theme="dark"] .suggestion-chip {
    background: var(--dark-secondary);
    border: 1px solid var(--dark-border);
    color: var(--dark-text);
  }

  .suggestion-chip:hover {
    background: var(--primary);
    color: white;
    border-color: var(--primary);
    transform: translateY(-2px);
  }

  .chat-input {
    display: flex;
    background: #fff;
    padding: 15px 25px;
    border-top: 1px solid var(--light-border);
    position: relative;
  }

  body[data-theme="dark"] .chat-input {
    background: var(--dark-secondary);
    border-top: 1px solid var(--dark-border);
  }

  .chat-input-wrapper {
    display: flex;
    flex: 1;
    position: relative;
    align-items: center;
    border: 1px solid var(--light-border);
    border-radius: 24px;
    background: var(--light-bg);
    transition: all 0.3s ease;
    box-shadow: var(--shadow-sm);
  }

  body[data-theme="dark"] .chat-input-wrapper {
    border: 1px solid var(--dark-border);
    background: var(--dark-bg);
  }

  .chat-input-wrapper:focus-within {
    box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.3);
    border-color: var(--primary);
  }

  .chat-input input {
    flex: 1;
    padding: 14px 20px;
    font-size: 15px;
    border: none;
    border-radius: 24px;
    outline: none;
    background: transparent;
    color: var(--light-text);
  }

  body[data-theme="dark"] .chat-input input {
    color: var(--dark-text);
  }

  .chat-input button {
    background: var(--primary);
    border: none;
    padding: 10px;
    width: 42px;
    height: 42px;
    display: flex;
    align-items: center;
    justify-content: center;
    color: white;
    font-size: 18px;
    border-radius: 50%;
    cursor: pointer;
    transition: all 0.2s ease;
    margin-right: 6px;
  }

  .chat-input button:hover {
    background: var(--primary-dark);
    transform: scale(1.05);
  }
    /* ===== TIMER TAB STYLES ===== */
    .exam-tabs {
    display: flex;
    justify-content: center;
    margin: 20px 0 30px;
    gap: 15px;
  }

  .exam-tabs button {
    padding: 12px 25px;
    background: white;
    border: 1px solid var(--primary);
    border-radius: 12px;
    color: var(--primary);
    cursor: pointer;
    font-weight: 600;
    transition: all 0.2s ease;
  }

  body[data-theme="dark"] .exam-tabs button {
    background: var(--dark-secondary);
  }

  .exam-tabs button:hover {
    background: var(--light-hover);
    transform: translateY(-2px);
  }

  body[data-theme="dark"] .exam-tabs button:hover {
    background: var(--dark-hover);
  }

  .exam-tabs button.active {
    background: var(--primary);
    color: white;
  }

  .countdown {
    font-size: 32px;
    font-weight: bold;
    margin-top: 20px;
    background: white;
    padding: 30px;
    border-radius: 16px;
    color: var(--primary);
    text-align: center;
    box-shadow: var(--shadow-md);
    position: relative;
    overflow: hidden;
    max-width: 800px;
    margin: 0 auto;
    width: 100%;
  }

  body[data-theme="dark"] .countdown {
    background: var(--dark-secondary);
  }

  .countdown::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    width: 5px;
    height: 100%;
    background: var(--primary);
  }

  .countdown-title {
    font-size: 18px;
    font-weight: 600;
    margin-bottom: 15px;
    color: var(--light-text);
  }

  body[data-theme="dark"] .countdown-title {
    color: var(--dark-text);
  }

  .time-unit {
    display: inline-block;
    background: var(--light-bg);
    padding: 12px 15px;
    border-radius: 12px;
    margin: 0 5px;
    min-width: 90px;
  }

  body[data-theme="dark"] .time-unit {
    background: var(--dark-bg);
  }

  .time-value {
    font-size: 40px;
    color: var(--primary);
  }

  .time-label {
    font-size: 12px;
    text-transform: uppercase;
    color: #666;
    font-weight: 500;
  }

  body[data-theme="dark"] .time-label {
    color: #aaa;
  }

  /* ===== PLANNER TAB STYLES ===== */
  .planner-container {
    display: flex;
    flex-direction: column;
    height: 100%;
    overflow: hidden;
  }

  .planner-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
  }

  .planner-header h2 {
    font-size: 22px;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .planner-header h2 i {
    color: var(--primary);
  }

  .planner-actions {
    display: flex;
    gap: 10px;
  }

  .planner-btn {
    padding: 10px 16px;
    background: white;
    border: 1px solid var(--light-border);
    border-radius: 8px;
    font-size: 14px;
    font-weight: 500;
    color: var(--light-text);
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 6px;
    transition: all 0.2s ease;
  }

  body[data-theme="dark"] .planner-btn {
    background: var(--dark-secondary);
    border: 1px solid var(--dark-border);
    color: var(--dark-text);
  }

  .planner-btn:hover {
    border-color: var(--primary);
    color: var(--primary);
  }

  .planner-btn.primary {
    background: var(--primary);
    color: white;
    border-color: var(--primary);
  }

  .planner-btn.primary:hover {
    background: var(--primary-dark);
  }

  .timetable {
    flex: 1;
    display: flex;
    flex-direction: column;
    background: white;
    border-radius: 12px;
    overflow: hidden;
    box-shadow: var(--shadow-md);
  }

  body[data-theme="dark"] .timetable {
    background: var(--dark-secondary);
  }

  .timetable-header {
    display: grid;
    grid-template-columns: 80px repeat(7, 1fr);
    background: var(--primary);
    color: white;
    font-weight: 600;
  }

  .timetable-header-cell {
    padding: 12px;
    text-align: center;
    font-size: 14px;
  }

  .timetable-body {
    display: grid;
    grid-template-columns: 80px repeat(7, 1fr);
    grid-auto-rows: 70px;
    flex: 1;
    overflow-y: auto;
  }

  .time-cell {
    padding: 10px;
    border-right: 1px solid var(--light-border);
    border-bottom: 1px solid var(--light-border);
    font-size: 12px;
    font-weight: 500;
    color: #666;
    display: flex;
    align-items: center;
    justify-content: center;
    background: #f9f9f9;
  }

  body[data-theme="dark"] .time-cell {
    border-right: 1px solid var(--dark-border);
    border-bottom: 1px solid var(--dark-border);
    color: #aaa;
    background: var(--dark-hover);
  }

  .schedule-cell {
    padding: 8px;
    border-right: 1px solid var(--light-border);
    border-bottom: 1px solid var(--light-border);
    position: relative;
    transition: all 0.2s ease;
  }

  body[data-theme="dark"] .schedule-cell {
    border-right: 1px solid var(--dark-border);
    border-bottom: 1px solid var(--dark-border);
  }

  .schedule-cell:hover {
    background: var(--light-hover);
  }

  body[data-theme="dark"] .schedule-cell:hover {
    background: var(--dark-hover);
  }

  .task {
    position: absolute;
    top: 2px;
    left: 2px;
    right: 2px;
    bottom: 2px;
    background: rgba(99, 102, 241, 0.1);
    border-left: 4px solid var(--primary);
    border-radius: 6px;
    padding: 6px;
    font-size: 12px;
    overflow: hidden;
    cursor: pointer;
    transition: all 0.2s ease;
    display: flex;
    flex-direction: column;
  }

  .task:hover {
    transform: scale(1.02);
    box-shadow: var(--shadow-sm);
  }

  .task.math {
    background: rgba(236, 72, 153, 0.1);
    border-left-color: var(--secondary);
  }

  .task.physics {
    background: rgba(16, 185, 129, 0.1);
    border-left-color: var(--success);
  }

  .task.english {
    background: rgba(245, 158, 11, 0.1);
    border-left-color: var(--warning);
  }

  .task-title {
    font-weight: 600;
    margin-bottom: 2px;
    color: var(--light-text);
  }

  body[data-theme="dark"] .task-title {
    color: var(--dark-text);
  }

  .task-time {
    font-size: 10px;
    color: #666;
  }

  body[data-theme="dark"] .task-time {
    color: #aaa;
  }

  /* ===== MODAL STYLES ===== */
  .modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0,0,0,0.5);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 1000;
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
  }

  .modal-overlay.show {
    opacity: 1;
    visibility: visible;
  }

  .modal {
    background: white;
    width: 90%;
    max-width: 500px;
    border-radius: 12px;
    box-shadow: var(--shadow-lg);
    transform: translateY(20px);
    transition: all 0.3s ease;
    overflow: hidden;
  }

  body[data-theme="dark"] .modal {
    background: var(--dark-secondary);
  }

  .modal-overlay.show .modal {
    transform: translateY(0);
  }

  .modal-header {
    padding: 15px 20px;
    border-bottom: 1px solid var(--light-border);
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  body[data-theme="dark"] .modal-header {
    border-bottom: 1px solid var(--dark-border);
  }

  .modal-header h3 {
    font-size: 18px;
    font-weight: 600;
  }

  .modal-close {
    background: none;
    border: none;
    font-size: 20px;
    cursor: pointer;
    color: #666;
  }

  body[data-theme="dark"] .modal-close {
    color: #aaa;
  }

  .modal-body {
    padding: 20px;
  }

  .modal-footer {
    padding: 15px 20px;
    border-top: 1px solid var(--light-border);
    display: flex;
    justify-content: flex-end;
    gap: 10px;
  }

  body[data-theme="dark"] .modal-footer {
    border-top: 1px solid var(--dark-border);
  }

  .btn {
    padding: 10px 16px;
    border-radius: 8px;
    font-size: 14px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s ease;
  }

  .btn-secondary {
    background: #f1f5f9;
    border: 1px solid #e2e8f0;
    color: #334155;
  }

  body[data-theme="dark"] .btn-secondary {
    background: var(--dark-hover);
    border: 1px solid var(--dark-border);
    color: var(--dark-text);
  }

  .btn-primary {
    background: var(--primary);
    border: 1px solid var(--primary);
    color: white;
  }

  .btn:hover {
    transform: translateY(-2px);
  }

  .btn-secondary:hover {
    background: #e2e8f0;
  }

  .btn-primary:hover {
    background: var(--primary-dark);
  }

  /* ===== SCORE CALCULATOR STYLES ===== */
  .score-calculator {
    display: flex;
    flex-direction: column;
    max-width: 800px;
    margin: 0 auto;
    width: 100%;
  }

  .calculator-header {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 20px;
  }

  .calculator-header i {
    font-size: 24px;
    color: var(--primary);
  }

  .calculator-header h2 {
    font-size: 22px;
    font-weight: 600;
  }

  .exam-selector {
    background: white;
    border-radius: 12px;
    padding: 20px;
    box-shadow: var(--shadow-md);
    margin-bottom: 20px;
  }

  body[data-theme="dark"] .exam-selector {
    background: var(--dark-secondary);
  }

  .exam-type-tabs {
    display: flex;
    gap: 10px;
    margin-bottom: 20px;
  }

  .exam-type-tab {
    padding: 10px 16px;
    border-radius: 8px;
    cursor: pointer;
    font-weight: 500;
    transition: all 0.2s ease;
  }

  body[data-theme="dark"] .exam-type-tab {
    border: 1px solid var(--dark-border);
  }

  .exam-type-tab.active {
    background: var(--primary);
    color: white;
    border-color: var(--primary);
  }

  .calculator-form {
    background: white;
    border-radius: 12px;
    padding: 20px;
    box-shadow: var(--shadow-md);
  }

  body[data-theme="dark"] .calculator-form {
    background: var(--dark-secondary);
  }

  .form-row {
    display: flex;
    gap: 15px;
    margin-bottom: 15px;
  }

  .form-col {
    flex: 1;
  }

  .form-group {
    margin-bottom: 15px;
  }

  .form-group label {
    display: block;
    margin-bottom: 8px;
    font-weight: 500;
    color: var(--light-text);
  }

  body[data-theme="dark"] .form-group label {
    color: var(--dark-text);
  }

  .form-control {
    padding: 12px 16px;
    border: 1px solid var(--light-border);
    border-radius: 8px;
    font-size: 15px;
    width: 100%;
    background: var(--light-bg);
    transition: all 0.2s ease;
    color: var(--light-text);
  }

  body[data-theme="dark"] .form-control {
    border: 1px solid var(--dark-border);
    background: var(--dark-bg);
    color: var(--dark-text);
  }

  .form-control:focus {
    border-color: var(--primary);
    box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.25);
    outline: none;
  }

  .results {
    margin-top: 20px;
    padding-top: 20px;
    border-top: 1px solid var(--light-border);
  }

  body[data-theme="dark"] .results {
    border-top: 1px solid var(--dark-border);
  }

  .result-item {
    display: flex;
    justify-content: space-between;
    padding: 10px 0;
    border-bottom: 1px dashed var(--light-border);
  }

  body[data-theme="dark"] .result-item {
    border-bottom: 1px dashed var(--dark-border);
  }

  .result-item:last-child {
    border-bottom: none;
    font-weight: bold;
  }

  .result-label {
    color: #666;
  }

  body[data-theme="dark"] .result-label {
    color: #aaa;
  }

  .result-value {
    font-weight: 600;
    color: var(--primary);
  }

    /* ===== SETTINGS TAB STYLES ===== */
    .settings-container {
    background: white;
    border-radius: 16px;
    padding: 25px;
    box-shadow: var(--shadow-md);
    max-width: 800px;
    margin: 0 auto;
    width: 100%;
  }

  body[data-theme="dark"] .settings-container {
    background: var(--dark-secondary);
  }

  .settings-header {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 20px;
    padding-bottom: 15px;
    border-bottom: 1px solid var(--light-border);
  }

  body[data-theme="dark"] .settings-header {
    border-bottom: 1px solid var(--dark-border);
  }

  .settings-header i {
    font-size: 24px;
    color: var(--primary);
  }

  .settings-header h2 {
    font-size: 22px;
    font-weight: 600;
  }

  .settings-group {
    margin-bottom: 25px;
  }

  .settings-group h3 {
    display: flex;
    align-items: center;
    gap: 10px;
    font-size: 18px;
    margin-bottom: 15px;
    color: var(--light-text);
  }

  body[data-theme="dark"] .settings-group h3 {
    color: var(--dark-text);
  }

  .settings-group h3 i {
    color: var(--primary);
  }

  .color-options {
    display: flex;
    gap: 15px;
    margin-top: 10px;
  }

  .color-option {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    cursor: pointer;
    position: relative;
    border: 2px solid transparent;
    transition: all 0.2s ease;
  }

  .color-option.active {
    border-color: white;
    box-shadow: 0 0 0 2px var(--primary);
    transform: scale(1.1);
  }

  .switch {
    position: relative;
    display: inline-block;
    width: 50px;
    height: 24px;
  }

  .switch input {
    opacity: 0;
    width: 0;
    height: 0;
  }

  .slider {
    position: absolute;
    cursor: pointer;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: #ccc;
    transition: .4s;
    border-radius: 24px;
  }

  .slider:before {
    position: absolute;
    content: "";
    height: 16px;
    width: 16px;
    left: 4px;
    bottom: 4px;
    background-color: white;
    transition: .4s;
    border-radius: 50%;
  }

  input:checked + .slider {
    background-color: var(--primary);
  }

  input:focus + .slider {
    box-shadow: 0 0 1px var(--primary);
  }

  input:checked + .slider:before {
    transform: translateX(26px);
  }

  .toggle-control {
    display: flex;
    align-items: center;
    justify-content: space-between;
  }

  .toggle-label {
    font-weight: 500;
    color: var(--light-text);
  }

  body[data-theme="dark"] .toggle-label {
    color: var(--dark-text);
  }

  /* ===== AI TIPS STYLES ===== */
  .ai-tips {
    background: white;
    border-radius: 12px;
    padding: 20px;
    box-shadow: var(--shadow-md);
    margin-top: 20px;
    border-left: 4px solid var(--primary);
    max-width: 800px;
    margin: 20px auto 0;
    width: 100%;
  }

  body[data-theme="dark"] .ai-tips {
    background: var(--dark-secondary);
  }

  .ai-tips-header {
    display: flex;
    align-items: center;
    gap: 10px;
    margin-bottom: 15px;
  }

  .ai-tips-header i {
    color: var(--primary);
    font-size: 20px;
  }

  .ai-tips-title {
    font-size: 16px;
    font-weight: 600;
  }

  .ai-tips-content {
    font-size: 14px;
    line-height: 1.6;
  }

  .ai-tips-actions {
    margin-top: 15px;
    display: flex;
    justify-content: flex-end;
  }

  /* ===== PROGRESS TRACKER STYLES ===== */
  .progress-tracker {
    background: white;
    border-radius: 12px;
    padding: 20px;
    box-shadow: var(--shadow-md);
    margin-top: 20px;
    max-width: 800px;
    margin: 20px auto 0;
    width: 100%;
  }

  body[data-theme="dark"] .progress-tracker {
    background: var(--dark-secondary);
  }

  .progress-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
  }

  .progress-title {
    font-size: 16px;
    font-weight: 600;
  }

  .progress-date {
    font-size: 14px;
    color: #666;
  }

  body[data-theme="dark"] .progress-date {
    color: #aaa;
  }

  .progress-bars {
    display: flex;
    flex-direction: column;
    gap: 15px;
  }

  .progress-item {
    display: flex;
    flex-direction: column;
    gap: 5px;
  }

  .progress-label {
    display: flex;
    justify-content: space-between;
    font-size: 14px;
  }

  .progress-subject {
    font-weight: 500;
  }

  .progress-percentage {
    color: var(--primary);
    font-weight: 600;
  }

  .progress-bar {
    height: 8px;
    background: #e2e8f0;
    border-radius: 4px;
    overflow: hidden;
  }

  body[data-theme="dark"] .progress-bar {
    background: var(--dark-hover);
  }

  .progress-fill {
    height: 100%;
    background: var(--primary);
    border-radius: 4px;
    transition: width 0.5s ease;
  }

  .progress-fill.math {
    background: var(--secondary);
  }

  .progress-fill.physics {
    background: var(--success);
  }

  .progress-fill.english {
    background: var(--warning);
  }

  /* ===== NOTIFICATION SYSTEM STYLES ===== */
  .notification-container {
    position: fixed;
    top: 20px;
    right: 20px;
    width: 300px;
    z-index: 1000;
  }

  .notification {
    background: white;
    border-radius: 8px;
    box-shadow: var(--shadow-md);
    margin-bottom: 10px;
    overflow: hidden;
    animation: slideIn 0.3s ease-out;
  }

  body[data-theme="dark"] .notification {
    background: var(--dark-secondary);
  }

  @keyframes slideIn {
    from { transform: translateX(100%); opacity: 0; }
    to { transform: translateX(0); opacity: 1; }
  }

  .notification-header {
    padding: 12px 15px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    border-bottom: 1px solid var(--light-border);
  }

  body[data-theme="dark"] .notification-header {
    border-bottom: 1px solid var(--dark-border);
  }

  .notification-title {
    font-weight: 600;
    font-size: 14px;
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .notification-title i {
    color: var(--primary);
  }

  .notification-close {
    background: none;
    border: none;
    font-size: 16px;
    cursor: pointer;
    color: #666;
  }

  body[data-theme="dark"] .notification-close {
    color: #aaa;
  }

  .notification-body {
    padding: 12px 15px;
    font-size: 14px;
    line-height: 1.5;
  }

  .notification-actions {
    padding: 10px 15px;
    display: flex;
    justify-content: flex-end;
    gap: 10px;
  }

  .notification-btn {
    padding: 6px 12px;
    border-radius: 6px;
    font-size: 12px;
    cursor: pointer;
    transition: all 0.2s ease;
  }

  .notification-primary {
    background: var(--primary);
    color: white;
    border: none;
  }

  .notification-secondary {
    background: transparent;
    color: var(--primary);
    border: 1px solid var(--primary);
  }

  /* ===== ADMIN PANEL STYLES ===== */
  .admin-container {
    display: flex;
    flex-direction: column;
    height: 100%;
  }

  .admin-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 20px;
  }

  .admin-header h2 {
    font-size: 24px;
    font-weight: 600;
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .admin-header h2 i {
    color: var(--primary);
  }

  .admin-stats {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
  }

  .stat-card {
    background: white;
    border-radius: 12px;
    padding: 20px;
    box-shadow: var(--shadow-md);
    display: flex;
    flex-direction: column;
  }

  body[data-theme="dark"] .stat-card {
    background: var(--dark-secondary);
  }

  .stat-title {
    font-size: 14px;
    color: #666;
    margin-bottom: 10px;
    display: flex;
    align-items: center;
    gap: 8px;
  }

  body[data-theme="dark"] .stat-title {
    color: #aaa;
  }

  .stat-title i {
    color: var(--primary);
  }

  .stat-value {
    font-size: 28px;
    font-weight: 700;
    color: var(--primary);
  }

  .admin-tabs {
    display: flex;
    border-bottom: 1px solid var(--light-border);
    margin-bottom: 20px;
  }

  body[data-theme="dark"] .admin-tabs {
    border-bottom: 1px solid var(--dark-border);
  }

  .admin-tab {
    padding: 12px 20px;
    font-weight: 500;
    cursor: pointer;
    position: relative;
  }

  .admin-tab.active {
    color: var(--primary);
  }

  .admin-tab.active::after {
    content: '';
    position: absolute;
    bottom: -1px;
    left: 0;
    right: 0;
    height: 2px;
    background: var(--primary);
  }

  .admin-tab-content {
    display: none;
    background: white;
    border-radius: 12px;
    padding: 20px;
    box-shadow: var(--shadow-md);
    margin-bottom: 20px;
  }

  body[data-theme="dark"] .admin-tab-content {
    background: var(--dark-secondary);
  }

  .admin-tab-content.active {
    display: block;
  }

  .admin-table {
    width: 100%;
    border-collapse: collapse;
  }

  .admin-table th, .admin-table td {
    padding: 12px 15px;
    text-align: left;
    border-bottom: 1px solid var(--light-border);
  }

  body[data-theme="dark"] .admin-table th, body[data-theme="dark"] .admin-table td {
    border-bottom: 1px solid var(--dark-border);
  }

  .admin-table th {
    font-weight: 600;
    color: #666;
  }

  body[data-theme="dark"] .admin-table th {
    color: #aaa;
  }

  .admin-table tr:hover {
    background: var(--light-hover);
  }

  body[data-theme="dark"] .admin-table tr:hover {
    background: var(--dark-hover);
  }

  .admin-table .actions {
    display: flex;
    gap: 8px;
  }

  .admin-table .action-btn {
    padding: 6px 10px;
    border-radius: 6px;
    font-size: 12px;
    cursor: pointer;
    transition: all 0.2s ease;
  }

  .admin-table .view-btn {
    background: var(--light-hover);
    color: var(--primary);
    border: 1px solid var(--primary);
  }

  body[data-theme="dark"] .admin-table .view-btn {
    background: var(--dark-hover);
  }

  .admin-table .edit-btn {
    background: var(--light-hover);
    color: var(--warning);
    border: 1px solid var(--warning);
  }

  body[data-theme="dark"] .admin-table .edit-btn {
    background: var(--dark-hover);
  }

  .admin-table .delete-btn {
    background: var(--light-hover);
    color: var(--danger);
    border: 1px solid var(--danger);
  }

  body[data-theme="dark"] .admin-table .delete-btn {
    background: var(--dark-hover);
  }

  .admin-table .action-btn:hover {
    transform: translateY(-2px);
  }

  .admin-form {
    display: flex;
    flex-direction: column;
    gap: 15px;
  }

  .admin-form-row {
    display: flex;
    gap: 15px;
  }

  .admin-form-col {
    flex: 1;
  }

  .admin-form-group {
    margin-bottom: 15px;
  }

  .admin-form-group label {
    display: block;
    margin-bottom: 8px;
    font-weight: 500;
  }

  .admin-form-control {
    padding: 12px 16px;
    border: 1px solid var(--light-border);
    border-radius: 8px;
    font-size: 15px;
    width: 100%;
    background: var(--light-bg);
    transition: all 0.2s ease;
  }

  body[data-theme="dark"] .admin-form-control {
    border: 1px solid var(--dark-border);
    background: var(--dark-bg);
    color: var(--dark-text);
  }

  .admin-form-control:focus {
    border-color: var(--primary);
    box-shadow: 0 0 0 2px rgba(99, 102, 241, 0.25);
    outline: none;
  }

  .admin-form-actions {
    display: flex;
    justify-content: flex-end;
    gap: 10px;
    margin-top: 20px;
  }

    /* ===== RESPONSIVE STYLES ===== */
    @media (max-width: 768px) {
    .sidebar {
      position: fixed;
      left: -280px;
      height: 100vh;
      z-index: 100;
    }
    
    .sidebar.show {
      left: 0;
    }
    
    .mobile-toggle {
      display: block !important;
    }
    
    .form-row {
      flex-direction: column;
    }

    .timetable-header, .timetable-body {
      grid-template-columns: 60px repeat(7, 1fr);
    }

    .time-unit {
      min-width: 70px;
      padding: 8px 10px;
    }

    .time-value {
      font-size: 30px;
    }

    .admin-stats {
      grid-template-columns: 1fr;
    }

    .admin-form-row {
      flex-direction: column;
    }
  }

  .mobile-toggle {
    display: none;
    background: none;
    border: none;
    font-size: 24px;
    margin-right: 15px;
    cursor: pointer;
    color: var(--light-text);
  }

  body[data-theme="dark"] .mobile-toggle {
    color: var(--dark-text);
  }

  /* ===== LOADING ANIMATION ===== */
  .loading-dots {
    display: flex;
    gap: 5px;
    align-items: center;
  }

  .loading-dot {
    width: 8px;
    height: 8px;
    background-color: var(--primary);
    border-radius: 50%;
    animation: bounce 1.5s infinite ease-in-out;
  }

  .loading-dot:nth-child(1) {
    animation-delay: 0s;
  }

  .loading-dot:nth-child(2) {
    animation-delay: 0.2s;
  }

  .loading-dot:nth-child(3) {
    animation-delay: 0.4s;
  }

  @keyframes bounce {
    0%, 80%, 100% { transform: translateY(0); }
    40% { transform: translateY(-10px); }
  }

  /* ===== PLANNER SELECTOR STYLES ===== */
  .planner-selector {
    margin-bottom: 20px;
    display: flex;
    align-items: center;
    gap: 15px;
  }

  .planner-selector select {
    padding: 10px 15px;
    border-radius: 8px;
    border: 1px solid var(--light-border);
    background: white;
    color: var(--light-text);
    font-size: 14px;
    min-width: 200px;
  }

  body[data-theme="dark"] .planner-selector select {
    background: var(--dark-secondary);
    border: 1px solid var(--dark-border);
    color: var(--dark-text);
  }

  .planner-selector button {
    padding: 10px 15px;
    border-radius: 8px;
    background: var(--primary);
    color: white;
    border: none;
    font-size: 14px;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 8px;
  }

  .planner-selector button:hover {
    background: var(--primary-dark);
  }
</style>
</head>
<body data-theme="light">
<div class="sidebar" id="sidebar">
  <h1><i class="fas fa-robot"></i> ebfl.ai</h1>
  <div class="user-profile">
    <div class="avatar">U</div>
    <div class="user-info">
      <div class="name">Kullanıcı</div>
      <div class="role">Öğrenci</div>
    </div>
  </div>
  <button class="menu-button active" data-tab="chatbot">
    <i class="fas fa-comment-dots"></i> Yapay Zeka Chatbot
  </button>
  <button class="menu-button" data-tab="planner">
    <i class="fas fa-calendar-alt"></i> AI Destekli Ders Programı
  </button>
  <button class="menu-button" data-tab="timer">
    <i class="fas fa-stopwatch"></i> Sınav Sayacı
  </button>
  <button class="menu-button" data-tab="score">
    <i class="fas fa-calculator"></i> Sınav Puan Hesaplama
  </button>
  <button class="menu-button" data-tab="settings">
    <i class="fas fa-cog"></i> Ayarlar
  </button>
  <button class="menu-button" data-tab="admin" id="admin-menu-button" style="display: none;">
    <i class="fas fa-user-shield"></i> Admin Paneli
  </button>
  
  <div class="chat-history">
    <h3>Bugün</h3>
    <div id="chat-history-items">
      <!-- Sohbet geçmişi buraya dinamik olarak eklenecek -->
      <div class="chat-item">
        <i class="fas fa-history"></i>
        <span>Yapay Zeka Eğitim Platformu</span>
      </div>
    </div>
  </div>
  
  <div class="theme-toggle">
    <button id="theme-toggle-btn">
      <i class="fas fa-moon" id="theme-icon"></i>
    </button>
  </div>
</div>

<div class="chat-main">
  <div class="header-bar">
    <div class="mobile-toggle" id="mobile-toggle">
      <i class="fas fa-bars"></i>
    </div>
    <div class="title"><i class="fas fa-robot"></i> Yapay Zeka Asistanı</div>
    <div class="auth-buttons">
      <button id="login-button">Giriş Yap</button>
      <button id="register-button">Kayıt Ol</button>
    </div>
  </div>
  
  <!-- Chatbot Tab -->
  <div id="chatbot" class="tab-content active">
    <div class="chat-body" id="chat-body">
      <div class="message assistant">
        Merhaba! Ben ebfl.ai yapay zeka asistanınızım. Size derslerinizde nasıl yardımcı olabilirim?
        <div class="message-actions">
          <button class="message-action"><i class="fas fa-thumbs-up"></i> Yararlı</button>
          <button class="message-action"><i class="fas fa-reply"></i> Yanıtla</button>
        </div>
      </div>
      
      <div class="suggestions">
        <div class="suggestion-chip">Matematik çalışmama yardım et</div>
        <div class="suggestion-chip">TYT'ye nasıl hazırlanmalıyım?</div>
        <div class="suggestion-chip">Fizik formüllerini öğret</div>
        <div class="suggestion-chip">Edebiyat konularını özetler misin?</div>
        <div class="suggestion-chip">Biyoloji çalışma programı oluştur</div>
      </div>
    </div>
    
    <div class="chat-input">
      <div class="chat-input-wrapper">
        <input type="text" id="chat-input-field" placeholder="Bir şeyler yaz..." onkeydown="if(event.key === 'Enter') sendMessage()">
        <button onclick="sendMessage()"><i class="fas fa-paper-plane"></i></button>
      </div>
    </div>
  </div>
  
  <!-- Timer Tab -->
  <div id="timer" class="tab-content">
    <div class="exam-tabs">
      <button class="active" data-exam="TYT">TYT</button>
      <button data-exam="AYT">AYT</button>
    </div>
    
    <div class="countdown">
      <div class="countdown-title">TYT sınavına kalan süre:</div>
      <div>
        <div class="time-unit">
          <div class="time-value" id="days">00</div>
          <div class="time-label">Gün</div>
        </div>
        <div class="time-unit">
          <div class="time-value" id="hours">00</div>
          <div class="time-label">Saat</div>
        </div>
        <div class="time-unit">
          <div class="time-value" id="minutes">00</div>
          <div class="time-label">Dakika</div>
        </div>
        <div class="time-unit">
          <div class="time-value" id="seconds">00</div>
          <div class="time-label">Saniye</div>
        </div>
      </div>
    </div>
    
    <div class="ai-tips">
      <div class="ai-tips-header">
        <i class="fas fa-lightbulb"></i>
        <div class="ai-tips-title">AI Önerisi</div>
      </div>
      <div class="ai-tips-content" id="exam-tip">
        TYT sınavında zaman yönetimi çok önemlidir. Her bölüm için sürenizi önceden planlayın.
      </div>
      <div class="ai-tips-actions">
        <button class="notification-btn notification-primary" onclick="showNextTip()">Daha Fazla Öneri</button>
      </div>
    </div>

    <div class="progress-tracker">
      <div class="progress-header">
        <div class="progress-title">Çalışma İstatistikleri</div>
        <div class="progress-date">Son 30 gün</div>
      </div>
      <div class="progress-bars">
        <div class="progress-item">
          <div class="progress-label">
            <span class="progress-subject">Matematik</span>
            <span class="progress-percentage">65%</span>
          </div>
          <div class="progress-bar">
            <div class="progress-fill math" style="width: 65%"></div>
          </div>
        </div>
        <div class="progress-item">
          <div class="progress-label">
            <span class="progress-subject">Fizik</span>
            <span class="progress-percentage">45%</span>
          </div>
          <div class="progress-bar">
            <div class="progress-fill physics" style="width: 45%"></div>
          </div>
        </div>
        <div class="progress-item">
          <div class="progress-label">
            <span class="progress-subject">Türkçe</span>
            <span class="progress-percentage">80%</span>
          </div>
          <div class="progress-bar">
            <div class="progress-fill" style="width: 80%"></div>
          </div>
        </div>
        <div class="progress-item">
          <div class="progress-label">
            <span class="progress-subject">İngilizce</span>
            <span class="progress-percentage">70%</span>
          </div>
          <div class="progress-bar">
            <div class="progress-fill english" style="width: 70%"></div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Planner Tab -->
  <div id="planner" class="tab-content">
    <div class="planner-container">
      <div class="planner-header">
        <h2><i class="fas fa-calendar-alt"></i> AI Destekli Ders Programı</h2>
        <div class="planner-actions">
          <button class="planner-btn" onclick="showPlannerSettings()">
            <i class="fas fa-sliders-h"></i> Ayarlar
          </button>
          <button class="planner-btn primary" onclick="showAddTaskModal()">
            <i class="fas fa-plus"></i> Ders Ekle
          </button>
        </div>
      </div>

      <div class="planner-selector">
        <select id="planner-select" class="form-control" onchange="loadSelectedPlanner()">
          <option value="">Ders programı seçin veya yeni oluşturun</option>
        </select>
        <button onclick="showNewPlannerModal()">
          <i class="fas fa-plus"></i> Yeni Program
        </button>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-3 gap-5 mb-5" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-bottom: 20px;">
        <div style="background: white; border-radius: 12px; padding: 20px; box-shadow: var(--shadow-md); border: 1px solid var(--light-border);">
          <h3 style="font-weight: 600; margin-bottom: 12px; display: flex; align-items: center; gap: 8px;">
            <i class="fas fa-clock" style="color: var(--primary);"></i>
            Toplam Çalışma Süresi
          </h3>
          <div style="font-size: 24px; font-weight: bold; color: var(--primary);" id="total-study-hours">3 saat</div>
          <p style="font-size: 14px; color: #666; margin-top: 4px;">Bu haftaki planlanan çalışma</p>
        </div>

        <div style="background: white; border-radius: 12px; padding: 20px; box-shadow: var(--shadow-md); border: 1px solid var(--light-border);">
          <h3 style="font-weight: 600; margin-bottom: 12px; display: flex; align-items: center; gap: 8px;">
            <i class="fas fa-bell" style="color: var(--primary);"></i>
            Yaklaşan Dersler
          </h3>
          <div style="font-size: 14px;" id="upcoming-classes">
            <div style="margin-bottom: 8px; display: flex; align-items: center; gap: 8px;">
              <div style="width: 8px; height: 8px; border-radius: 50%; background: var(--secondary);"></div>
              <span>Matematik - Pazartesi 10:00</span>
            </div>
            <div style="display: flex; align-items: center; gap: 8px;">
              <div style="width: 8px; height: 8px; border-radius: 50%; background: var(--success);"></div>
              <span>Fizik - Salı 11:00</span>
            </div>
          </div>
        </div>

        <div style="background: white; border-radius: 12px; padding: 20px; box-shadow: var(--shadow-md); border: 1px solid var(--light-border);">
          <h3 style="font-weight: 600; margin-bottom: 12px;">AI Önerisi</h3>
          <p style="font-size: 14px; color: #666;">
            Matematik ve Fizik derslerini sabah saatlerinde çalışmak daha verimli olabilir. Hafta sonları için daha uzun çalışma seansları planlayabilirsiniz.
          </p>
        </div>
      </div>
      
      <div class="timetable">
        <div class="timetable-header">
          <div class="timetable-header-cell">Saat</div>
          <div class="timetable-header-cell">Pazartesi</div>
          <div class="timetable-header-cell">Salı</div>
          <div class="timetable-header-cell">Çarşamba</div>
          <div class="timetable-header-cell">Perşembe</div>
          <div class="timetable-header-cell">Cuma</div>
          <div class="timetable-header-cell">Cumartesi</div>
          <div class="timetable-header-cell">Pazar</div>
        </div>
        <div class="timetable-body">
          <!-- 8:00 - 16:00 arası saatler -->
          <!-- 8:00 -->
          <div class="time-cell">8:00</div>
          <div class="schedule-cell" data-day="1" data-hour="8"></div>
          <div class="schedule-cell" data-day="2" data-hour="8"></div>
          <div class="schedule-cell" data-day="3" data-hour="8"></div>
          <div class="schedule-cell" data-day="4" data-hour="8"></div>
          <div class="schedule-cell" data-day="5" data-hour="8"></div>
          <div class="schedule-cell" data-day="6" data-hour="8"></div>
          <div class="schedule-cell" data-day="7" data-hour="8"></div>
          
          <!-- 9:00 -->
          <div class="time-cell">9:00</div>
          <div class="schedule-cell" data-day="1" data-hour="9"></div>
          <div class="schedule-cell" data-day="2" data-hour="9"></div>
          <div class="schedule-cell" data-day="3" data-hour="9"></div>
          <div class="schedule-cell" data-day="4" data-hour="9"></div>
          <div class="schedule-cell" data-day="5" data-hour="9"></div>
          <div class="schedule-cell" data-day="6" data-hour="9"></div>
          <div class="schedule-cell" data-day="7" data-hour="9"></div>
          
          <!-- 10:00 -->
          <div class="time-cell">10:00</div>
          <div class="schedule-cell" data-day="1" data-hour="10">
            <div class="task math" draggable="true" data-task-id="task1">
              <div class="task-title">Matematik</div>
              <div class="task-time">10:00 - 11:00</div>
            </div>
          </div>
          <div class="schedule-cell" data-day="2" data-hour="10"></div>
          <div class="schedule-cell" data-day="3" data-hour="10"></div>
          <div class="schedule-cell" data-day="4" data-hour="10"></div>
          <div class="schedule-cell" data-day="5" data-hour="10"></div>
          <div class="schedule-cell" data-day="6" data-hour="10"></div>
          <div class="schedule-cell" data-day="7" data-hour="10"></div>
          
          <!-- 11:00 -->
          <div class="time-cell">11:00</div>
          <div class="schedule-cell" data-day="1" data-hour="11"></div>
          <div class="schedule-cell" data-day="2" data-hour="11">
            <div class="task physics" draggable="true" data-task-id="task2">
              <div class="task-title">Fizik</div>
              <div class="task-time">11:00 - 12:00</div>
            </div>
          </div>
          <div class="schedule-cell" data-day="3" data-hour="11"></div>
          <div class="schedule-cell" data-day="4" data-hour="11"></div>
          <div class="schedule-cell" data-day="5" data-hour="11"></div>
          <div class="schedule-cell" data-day="6" data-hour="11"></div>
          <div class="schedule-cell" data-day="7" data-hour="11"></div>
                    <!-- 12:00 -->
                    <div class="time-cell">12:00</div>
                    <div class="schedule-cell" data-day="1" data-hour="12"></div>
                    <div class="schedule-cell" data-day="2" data-hour="12"></div>
                    <div class="schedule-cell" data-day="3" data-hour="12"></div>
                    <div class="schedule-cell" data-day="4" data-hour="12"></div>
                    <div class="schedule-cell" data-day="5" data-hour="12"></div>
                    <div class="schedule-cell" data-day="6" data-hour="12"></div>
                    <div class="schedule-cell" data-day="7" data-hour="12"></div>
                    
                    <!-- 13:00 -->
                    <div class="time-cell">13:00</div>
                    <div class="schedule-cell" data-day="1" data-hour="13"></div>
                    <div class="schedule-cell" data-day="2" data-hour="13"></div>
                    <div class="schedule-cell" data-day="3" data-hour="13"></div>
                    <div class="schedule-cell" data-day="4" data-hour="13"></div>
                    <div class="schedule-cell" data-day="5" data-hour="13"></div>
                    <div class="schedule-cell" data-day="6" data-hour="13"></div>
                    <div class="schedule-cell" data-day="7" data-hour="13"></div>
                    
                    <!-- 14:00 -->
                    <div class="time-cell">14:00</div>
                    <div class="schedule-cell" data-day="1" data-hour="14"></div>
                    <div class="schedule-cell" data-day="2" data-hour="14"></div>
                    <div class="schedule-cell" data-day="3" data-hour="14">
                      <div class="task english" draggable="true" data-task-id="task3">
                        <div class="task-title">İngilizce</div>
                        <div class="task-time">14:00 - 15:00</div>
                      </div>
                    </div>
                    <div class="schedule-cell" data-day="4" data-hour="14"></div>
                    <div class="schedule-cell" data-day="5" data-hour="14"></div>
                    <div class="schedule-cell" data-day="6" data-hour="14"></div>
                    <div class="schedule-cell" data-day="7" data-hour="14"></div>
                    
                    <!-- 15:00 -->
                    <div class="time-cell">15:00</div>
                    <div class="schedule-cell" data-day="1" data-hour="15"></div>
                    <div class="schedule-cell" data-day="2" data-hour="15"></div>
                    <div class="schedule-cell" data-day="3" data-hour="15"></div>
                    <div class="schedule-cell" data-day="4" data-hour="15"></div>
                    <div class="schedule-cell" data-day="5" data-hour="15"></div>
                    <div class="schedule-cell" data-day="6" data-hour="15"></div>
                    <div class="schedule-cell" data-day="7" data-hour="15"></div>
                    
                    <!-- 16:00 -->
                    <div class="time-cell">16:00</div>
                    <div class="schedule-cell" data-day="1" data-hour="16"></div>
                    <div class="schedule-cell" data-day="2" data-hour="16"></div>
                    <div class="schedule-cell" data-day="3" data-hour="16"></div>
                    <div class="schedule-cell" data-day="4" data-hour="16"></div>
                    <div class="schedule-cell" data-day="5" data-hour="16"></div>
                    <div class="schedule-cell" data-day="6" data-hour="16"></div>
                    <div class="schedule-cell" data-day="7" data-hour="16"></div>
                  </div>
                </div>
                
                <div style="margin-top: 20px; display: flex; justify-content: flex-end; gap: 10px;">
                  <button class="planner-btn" onclick="exportToPDF()">
                    <i class="fas fa-file-pdf"></i> PDF Olarak İndir
                  </button>
                  <button class="planner-btn primary" onclick="saveCurrentPlanner()">
                    <i class="fas fa-save"></i> Programı Kaydet
                  </button>
                </div>
              </div>
            </div>
            
            <!-- Score Tab -->
            <div id="score" class="tab-content">
              <div class="score-calculator">
                <div class="calculator-header">
                  <i class="fas fa-calculator"></i>
                  <h2>Sınav Puan Hesaplama</h2>
                </div>
                
                <div class="exam-selector">
                  <h3>Sınav Türü</h3>
                  <div class="exam-type-tabs">
                    <div class="exam-type-tab active" data-exam-type="tyt">TYT</div>
                    <div class="exam-type-tab" data-exam-type="ayt">AYT</div>
                  </div>
                  
                  <div id="tyt-form" class="calculator-form">
                    <div class="form-row">
                      <div class="form-col">
                        <div class="form-group">
                          <label>Türkçe (40 Soru)</label>
                          <div class="form-row">
                            <div class="form-col">
                              <div class="form-group">
                                <label for="turkishCorrect">Doğru</label>
                                <input type="number" id="turkishCorrect" class="form-control" min="0" max="40">
                              </div>
                            </div>
                            <div class="form-col">
                              <div class="form-group">
                                <label for="turkishWrong">Yanlış</label>
                                <input type="number" id="turkishWrong" class="form-control" min="0" max="40">
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="form-col">
                        <div class="form-group">
                          <label>Matematik (40 Soru)</label>
                          <div class="form-row">
                            <div class="form-col">
                              <div class="form-group">
                                <label for="mathCorrect">Doğru</label>
                                <input type="number" id="mathCorrect" class="form-control" min="0" max="40">
                              </div>
                            </div>
                            <div class="form-col">
                              <div class="form-group">
                                <label for="mathWrong">Yanlış</label>
                                <input type="number" id="mathWrong" class="form-control" min="0" max="40">
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    
                    <div class="form-row">
                      <div class="form-col">
                        <div class="form-group">
                          <label>Fen Bilimleri (20 Soru)</label>
                          <div class="form-row">
                            <div class="form-col">
                              <div class="form-group">
                                <label for="scienceCorrect">Doğru</label>
                                <input type="number" id="scienceCorrect" class="form-control" min="0" max="20">
                              </div>
                            </div>
                            <div class="form-col">
                              <div class="form-group">
                                <label for="scienceWrong">Yanlış</label>
                                <input type="number" id="scienceWrong" class="form-control" min="0" max="20">
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="form-col">
                        <div class="form-group">
                          <label>Sosyal Bilimler (20 Soru)</label>
                          <div class="form-row">
                            <div class="form-col">
                              <div class="form-group">
                                <label for="socialCorrect">Doğru</label>
                                <input type="number" id="socialCorrect" class="form-control" min="0" max="20">
                              </div>
                            </div>
                            <div class="form-col">
                              <div class="form-group">
                                <label for="socialWrong">Yanlış</label>
                                <input type="number" id="socialWrong" class="form-control" min="0" max="20">
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                    
                    <button class="btn btn-primary" onclick="calculateScore()">Hesapla</button>
                    
                    <div id="results" class="results" style="display: none;">
                      <div class="result-item">
                        <span class="result-label">Türkçe Net</span>
                        <span class="result-value" id="turkishNet">0</span>
                      </div>
                      <div class="result-item">
                        <span class="result-label">Matematik Net</span>
                        <span class="result-value" id="mathNet">0</span>
                      </div>
                      <div class="result-item">
                        <span class="result-label">Fen Bilimleri Net</span>
                        <span class="result-value" id="scienceNet">0</span>
                      </div>
                      <div class="result-item">
                        <span class="result-label">Sosyal Bilimler Net</span>
                        <span class="result-value" id="socialNet">0</span>
                      </div>
                      <div class="result-item">
                        <span class="result-label">Toplam Net</span>
                        <span class="result-value" id="totalNet">0</span>
                      </div>
                      <div class="result-item">
                        <span class="result-label">Tahmini Puan</span>
                        <span class="result-value" id="estimatedScore">0</span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- Settings Tab -->
            <div id="settings" class="tab-content">
              <div class="settings-container">
                <div class="settings-header">
                  <i class="fas fa-cog"></i>
                  <h2>Ayarlar</h2>
                </div>
                
                <div class="settings-group">
                  <h3><i class="fas fa-palette"></i> Görünüm Ayarları</h3>
                  
                  <div class="form-group">
                    <label>Tema Modu</label>
                    <div class="toggle-control">
                      <span class="toggle-label">Açık / Koyu Tema</span>
                      <label class="switch">
                        <input type="checkbox" id="dark-mode-toggle">
                        <span class="slider"></span>
                      </label>
                    </div>
                  </div>
                  
                  <div class="form-group">
                    <label>Renk Teması</label>
                    <div class="color-options">
                      <div class="color-option active" style="background-color: #6366f1;" data-color="purple"></div>
                      <div class="color-option" style="background-color: #3b82f6;" data-color="blue"></div>
                      <div class="color-option" style="background-color: #10b981;" data-color="green"></div>
                      <div class="color-option" style="background-color: #ec4899;" data-color="pink"></div>
                      <div class="color-option" style="background-color: #f59e0b;" data-color="orange"></div>
                      <div class="color-option" style="background-color: #ef4444;" data-color="red"></div>
                    </div>
                  </div>
                  
                  <div class="form-group">
                    <label>Animasyon Ayarları</label>
                    <div class="toggle-control">
                      <span class="toggle-label">Yumuşak geçişler ve animasyonlar</span>
                      <label class="switch">
                        <input type="checkbox" id="animations-toggle" checked>
                        <span class="slider"></span>
                      </label>
                    </div>
                  </div>
                </div>
                
                <div class="settings-group">
                  <h3><i class="fas fa-brain"></i> AI Ayarları</h3>
                  
                  <div class="form-group">
                    <div class="toggle-control">
                      <span class="toggle-label">AI Kişiselleştir</span>
                      <label class="switch">
                        <input type="checkbox" id="customize-ai-toggle">
                        <span class="slider"></span>
                      </label>
                    </div>
                  </div>
                  
                  <div id="ai-personalization-fields" style="display: none; margin-top: 15px; padding-left: 15px; border-left: 2px solid rgba(99, 102, 241, 0.2);">
                    <div class="form-group">
                      <label for="grade-select">Sınıf Seç</label>
                      <select id="grade-select" class="form-control">
                        <option value="9">9. Sınıf</option>
                        <option value="10">10. Sınıf</option>
                        <option value="11" selected>11. Sınıf</option>
                        <option value="12">12. Sınıf</option>
                      </select>
                    </div>
                    
                    <div class="form-group">
                      <label for="subject-select">Ders Seç</label>
                      <select id="subject-select" class="form-control">
                        <option value="Türk Dili ve Edebiyatı">Türk Dili ve Edebiyatı</option>
                        <option value="Matematik" selected>Matematik</option>
                        <option value="Fizik">Fizik</option>
                        <option value="Kimya">Kimya</option>
                        <option value="Biyoloji">Biyoloji</option>
                        <option value="Tarih">Tarih</option>
                        <option value="Coğrafya">Coğrafya</option>
                        <option value="Din Kültürü ve Ahlak Bilgisi">Din Kültürü ve Ahlak Bilgisi</option>
                        <option value="Yabancı Dil">Yabancı Dil</option>
                        <option value="Rehberlik ve Psikoloji">Rehberlik ve Psikoloji</option>
                      </select>
                    </div>
                  </div>
                </div>
                
                <div class="settings-group">
                  <h3>Bildirim Ayarları</h3>
                  
                  <div class="form-group">
                    <div class="toggle-control">
                      <span class="toggle-label">Çalışma Hatırlatıcıları</span>
                      <label class="switch">
                        <input type="checkbox" id="study-reminders-toggle" checked>
                        <span class="slider"></span>
                      </label>
                    </div>
                  </div>
                  
                  <div class="form-group">
                    <div class="toggle-control">
                      <span class="toggle-label">Sınav Geri Sayım Bildirimleri</span>
                      <label class="switch">
                        <input type="checkbox" id="exam-countdown-toggle" checked>
                        <span class="slider"></span>
                      </label>
                    </div>
                  </div>
                  
                  <div class="form-group">
                    <div class="toggle-control">
                      <span class="toggle-label">AI Önerileri</span>
                      <label class="switch">
                        <input type="checkbox" id="ai-suggestions-toggle" checked>
                        <span class="slider"></span>
                      </label>
                    </div>
                  </div>
                </div>
                
                <div style="margin-top: 20px; text-align: right;">
                  <button class="btn btn-primary" onclick="saveSettings()">Ayarları Kaydet</button>
                </div>
              </div>
            </div>
          
            <!-- Admin Panel Tab -->
            <div id="admin" class="tab-content">
              <div class="admin-container">
                <div class="admin-header">
                  <h2><i class="fas fa-user-shield"></i> Admin Paneli</h2>
                </div>
          
                <div class="admin-stats">
                  <div class="stat-card">
                    <div class="stat-title"><i class="fas fa-users"></i> Toplam Kullanıcı</div>
                    <div class="stat-value" id="total-users">0</div>
                  </div>
                  <div class="stat-card">
                    <div class="stat-title"><i class="fas fa-user-clock"></i> Aktif Kullanıcı</div>
                    <div class="stat-value" id="active-users">0</div>
                  </div>
                  <div class="stat-card">
                    <div class="stat-title"><i class="fas fa-comments"></i> Toplam Mesaj</div>
                    <div class="stat-value" id="total-messages">0</div>
                  </div>
                  <div class="stat-card">
                    <div class="stat-title"><i class="fas fa-server"></i> Sunucu Durumu</div>
                    <div class="stat-value" id="server-status">Bağlanıyor...</div>
                  </div>
                </div>
          
                <div class="admin-tabs">
                  <div class="admin-tab active" data-admin-tab="users">Kullanıcılar</div>
                  <div class="admin-tab" data-admin-tab="chats">Sohbet Geçmişi</div>
                  <div class="admin-tab" data-admin-tab="prompts">Sistem Promptları</div>
                  <div class="admin-tab" data-admin-tab="logs">Sistem Logları</div>
                  <div class="admin-tab" data-admin-tab="settings">Sistem Ayarları</div>
                </div>
          
                <!-- Users Tab -->
                <div class="admin-tab-content active" id="admin-users">
                  <table class="admin-table">
                    <thead>
                      <tr>
                        <th>ID</th>
                        <th>Ad Soyad</th>
                        <th>E-posta</th>
                        <th>Rol</th>
                        <th>Kayıt Tarihi</th>
                        <th>Son Giriş</th>
                        <th>İşlemler</th>
                      </tr>
                    </thead>
                    <tbody id="users-table-body">
                      <!-- Kullanıcılar buraya dinamik olarak eklenecek -->
                    </tbody>
                  </table>
                </div>
          
                <!-- Chats Tab -->
                <div class="admin-tab-content" id="admin-chats">
                  <table class="admin-table">
                    <thead>
                      <tr>
                        <th>ID</th>
                        <th>Kullanıcı</th>
                        <th>Konu</th>
                        <th>Mesaj Sayısı</th>
                        <th>Tarih</th>
                        <th>İşlemler</th>
                      </tr>
                    </thead>
                    <tbody id="chats-table-body">
                      <!-- Sohbet geçmişi buraya dinamik olarak eklenecek -->
                    </tbody>
                  </table>
                </div>
          
                <!-- Prompts Tab -->
                <div class="admin-tab-content" id="admin-prompts">
                  <div class="admin-form">
                    <div class="admin-form-group">
                      <label for="prompt-select">Prompt Seçin</label>
                      <select id="prompt-select" class="admin-form-control" onchange="loadSelectedPrompt()">
                        <option value="default">Varsayılan Sistem Promptu</option>
                        <option value="math">Matematik Dersi Promptu</option>
                        <option value="physics">Fizik Dersi Promptu</option>
                        <option value="literature">Edebiyat Dersi Promptu</option>
                        <option value="biology">Biyoloji Dersi Promptu</option>
                        <option value="chemistry">Kimya Dersi Promptu</option>
                        <option value="history">Tarih Dersi Promptu</option>
                        <option value="geography">Coğrafya Dersi Promptu</option>
                      </select>
                    </div>
                    
                    <div class="admin-form-group">
                      <label for="prompt-content">Prompt İçeriği</label>
                      <textarea id="prompt-content" class="admin-form-control" rows="10">Sen bir eğitim asistanısın. Öğrencilere derslerinde yardımcı olmak, sorularını cevaplamak ve konuları anlaşılır bir şekilde açıklamak için varsın. Öğrencilerin seviyelerine uygun, açık ve anlaşılır bir dil kullanmalısın. Verdiğin bilgiler doğru ve güncel olmalı. Öğrencilerin sorularını sabırla yanıtlamalı ve onları düşünmeye teşvik etmelisin.</textarea>
                    </div>
                    
                    <div class="admin-form-actions">
                      <button class="btn btn-secondary" onclick="resetPrompt()">Sıfırla</button>
                      <button class="btn btn-primary" onclick="savePrompt()">Kaydet</button>
                    </div>
                  </div>
                </div>
          
                <!-- Logs Tab -->
                <div class="admin-tab-content" id="admin-logs">
                  <div style="background: var(--dark-bg); color: var(--dark-text); padding: 15px; border-radius: 8px; font-family: monospace; height: 400px; overflow-y: auto;" id="system-logs">
                    <!-- Sistem logları buraya dinamik olarak eklenecek -->
                  </div>
                  <div style="margin-top: 15px; text-align: right;">
                    <button class="btn btn-secondary" onclick="clearLogs()">Logları Temizle</button>
                    <button class="btn btn-primary" onclick="downloadLogs()">Logları İndir</button>
                  </div>
                </div>
          
                <!-- Settings Tab -->
                <div class="admin-tab-content" id="admin-settings">
                  <div class="admin-form">
                    <div class="admin-form-group">
                      <label>API Ayarları</label>
                      <div class="admin-form-row">
                        <div class="admin-form-col">
                          <div class="admin-form-group">
                            <label for="api-provider">API Sağlayıcı</label>
                            <select id="api-provider" class="admin-form-control">
                              <option value="groq">Groq</option>
                              <option value="openai">OpenAI</option>
                              <option value="anthropic">Anthropic</option>
                              <option value="mistral">Mistral AI</option>
                            </select>
                          </div>
                        </div>
                        <div class="admin-form-col">
                          <div class="admin-form-group">
                            <label for="api-model">Model</label>
                            <select id="api-model" class="admin-form-control">
                              <option value="llama3-70b">Llama-3 70B</option>
                              <option value="llama3-8b">Llama-3 8B</option>
                              <option value="mixtral-8x7b">Mixtral 8x7B</option>
                              <option value="gemma-7b">Gemma 7B</option>
                            </select>
                          </div>
                        </div>
                      </div>
                      <div class="admin-form-group">
                        <label for="api-key">API Anahtarı</label>
                        <input type="password" id="api-key" class="admin-form-control" value="">
                      </div>
                    </div>
          
                    <div class="admin-form-group">
                      <label>Sistem Ayarları</label>
                      <div class="admin-form-row">
                        <div class="admin-form-col">
                          <div class="admin-form-group">
                            <label for="max-tokens">Maksimum Token</label>
                            <input type="number" id="max-tokens" class="admin-form-control" value="4096">
                          </div>
                        </div>
                        <div class="admin-form-col">
                          <div class="admin-form-group">
                            <label for="temperature">Sıcaklık</label>
                            <input type="number" id="temperature" class="admin-form-control" value="0.7" step="0.1" min="0" max="1">
                          </div>
                        </div>
                      </div>
                    </div>
          
                    <div class="admin-form-group">
                      <label>Sunucu Ayarları</label>
                      <div class="admin-form-row">
                        <div class="admin-form-col">
                          <div class="admin-form-group">
                            <label for="server-port">Port</label>
                            <input type="number" id="server-port" class="admin-form-control" value="3000">
                          </div>
                        </div>
                        <div class="admin-form-col">
                          <div class="admin-form-group">
                            <label for="server-timeout">Zaman Aşımı (ms)</label>
                            <input type="number" id="server-timeout" class="admin-form-control" value="30000">
                          </div>
                        </div>
                      </div>
                      <div class="admin-form-group">
                        <label for="server-status">Sunucu Durumu</label>
                        <div style="display: flex; align-items: center; gap: 10px;">
                          <div style="width: 12px; height: 12px; border-radius: 50%; background: var(--success);" id="server-status-indicator"></div>
                          <span id="server-status-text">Çalışıyor</span>
                          <button class="btn btn-secondary" style="margin-left: auto;" onclick="restartServer()">Yeniden Başlat</button>
                        </div>
                      </div>
                    </div>
          
                    <div class="admin-form-actions">
                      <button class="btn btn-secondary" onclick="resetAdminSettings()">Varsayılana Sıfırla</button>
                      <button class="btn btn-primary" onclick="saveAdminSettings()">Ayarları Kaydet</button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          
          <!-- Add Task Modal -->
          <div class="modal-overlay" id="add-task-modal">
            <div class="modal">
              <div class="modal-header">
                <h3>Yeni Ders Ekle</h3>
                <button class="modal-close" onclick="closeModal('add-task-modal')"><i class="fas fa-times"></i></button>
              </div>
              <div class="modal-body">
                <div class="form-group">
                  <label for="task-title">Ders Başlığı</label>
                  <input type="text" id="task-title" class="form-control" placeholder="Örn: Matematik Problemleri">
                </div>
                
                <div class="form-group">
                  <label for="task-subject">Ders</label>
                  <select id="task-subject" class="form-control">
                    <option value="">Ders seçin</option>
                    <option value="math">Matematik</option>
                    <option value="physics">Fizik</option>
                    <option value="chemistry">Kimya</option>
                    <option value="biology">Biyoloji</option>
                    <option value="english">İngilizce</option>
                    <option value="turkish">Türkçe</option>
                    <option value="history">Tarih</option>
                    <option value="geography">Coğrafya</option>
                  </select>
                </div>
                
                <div class="form-row">
                  <div class="form-col">
                    <div class="form-group">
                      <label for="task-day">Gün</label>
                      <select id="task-day" class="form-control">
                        <option value="1">Pazartesi</option>
                        <option value="2">Salı</option>
                        <option value="3">Çarşamba</option>
                        <option value="4">Perşembe</option>
                        <option value="5">Cuma</option>
                        <option value="6">Cumartesi</option>
                        <option value="7">Pazar</option>
                      </select>
                    </div>
                  </div>
                  <div class="form-col">
                    <div class="form-group">
                      <label for="task-hour">Saat</label>
                      <select id="task-hour" class="form-control">
                        <option value="8">08:00</option>
                        <option value="9">09:00</option>
                        <option value="10">10:00</option>
                        <option value="11">11:00</option>
                        <option value="12">12:00</option>
                        <option value="13">13:00</option>
                        <option value="14">14:00</option>
                        <option value="15">15:00</option>
                        <option value="16">16:00</option>
                        <option value="17">17:00</option>
                        <option value="18">18:00</option>
                        <option value="19">19:00</option>
                        <option value="20">20:00</option>
                      </select>
                    </div>
                  </div>
                </div>
                
                <div class="form-group">
                  <label for="task-duration">Süre (saat)</label>
                  <select id="task-duration" class="form-control">
                    <option value="1">1 saat</option>
                    <option value="2">2 saat</option>
                    <option value="3">3 saat</option>
                    <option value="4">4 saat</option>
                  </select>
                </div>
              </div>
              <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('add-task-modal')">İptal</button>
                <button class="btn btn-primary" onclick="addTask()">Ekle</button>
              </div>
            </div>
          </div>
          
          <!-- New Planner Modal -->
          <div class="modal-overlay" id="new-planner-modal">
            <div class="modal">
              <div class="modal-header">
                <h3>Yeni Ders Programı</h3>
                <button class="modal-close" onclick="closeModal('new-planner-modal')"><i class="fas fa-times"></i></button>
              </div>
              <div class="modal-body">
                <div class="form-group">
                  <label for="planner-name">Program Adı</label>
                  <input type="text" id="planner-name" class="form-control" placeholder="Örn: Haftalık Ders Programı">
                </div>
                
                <div class="form-group">
                  <label for="planner-description">Açıklama (İsteğe Bağlı)</label>
                  <textarea id="planner-description" class="form-control" placeholder="Program hakkında kısa bir açıklama"></textarea>
                </div>
              </div>
              <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('new-planner-modal')">İptal</button>
                <button class="btn btn-primary" onclick="createNewPlanner()">Oluştur</button>
              </div>
            </div>
          </div>
          
          <!-- Login Modal -->
          <div class="modal-overlay" id="login-modal">
            <div class="modal">
              <div class="modal-header">
                <h3>Giriş Yap</h3>
                <button class="modal-close" onclick="closeModal('login-modal')"><i class="fas fa-times"></i></button>
              </div>
              <div class="modal-body">
                <div class="form-group">
                  <label for="login-email">E-posta</label>
                  <input type="email" id="login-email" class="form-control" placeholder="E-posta adresiniz">
                </div>
                
                <div class="form-group">
                  <label for="login-password">Şifre</label>
                  <div style="position: relative;">
                    <input type="password" id="login-password" class="form-control" placeholder="Şifreniz">
                    <button type="button" style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); background: none; border: none; cursor: pointer;" onclick="togglePasswordVisibility('login-password')">
                      <i class="fas fa-eye" id="login-password-toggle"></i>
                    </button>
                  </div>
                </div>
                
                <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 15px;">
                  <div>
                    <input type="checkbox" id="remember-me" style="margin-right: 5px;">
                    <label for="remember-me" style="font-size: 14px;">Beni hatırla</label>
                  </div>
                  <a href="#" onclick="showForgotPasswordModal()" style="font-size: 14px; color: var(--primary); text-decoration: none;">Şifremi unuttum</a>
                </div>
              </div>
              <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('login-modal')">İptal</button>
                <button class="btn btn-primary" onclick="login()">Giriş Yap</button>
              </div>
            </div>
          </div>
          
          <!-- Register Modal -->
          <div class="modal-overlay" id="register-modal">
            <div class="modal">
              <div class="modal-header">
                <h3>Kayıt Ol</h3>
                <button class="modal-close" onclick="closeModal('register-modal')"><i class="fas fa-times"></i></button>
              </div>
              <div class="modal-body">
                <div class="form-row">
                  <div class="form-col">
                    <div class="form-group">
                      <label for="register-name">Ad</label>
                      <input type="text" id="register-name" class="form-control" placeholder="Adınız">
                    </div>
                  </div>
                  <div class="form-col">
                    <div class="form-group">
                      <label for="register-surname">Soyad</label>
                      <input type="text" id="register-surname" class="form-control" placeholder="Soyadınız">
                    </div>
                  </div>
                </div>
                
                <div class="form-group">
                  <label for="register-email">E-posta</label>
                  <input type="email" id="register-email" class="form-control" placeholder="E-posta adresiniz">
                </div>
                
                <div class="form-group">
                  <label for="register-password">Şifre</label>
                  <div style="position: relative;">
                    <input type="password" id="register-password" class="form-control" placeholder="Şifreniz" onkeyup="checkPasswordStrength()">
                    <button type="button" style="position: absolute; right: 10px; top: 50%; transform: translateY(-50%); background: none; border: none; cursor: pointer;" onclick="togglePasswordVisibility('register-password')">
                      <i class="fas fa-eye" id="register-password-toggle"></i>
                    </button>
                  </div>
                  <div id="password-strength" style="margin-top: 5px; font-size: 12px;">Şifre gücü: <span>Zayıf</span></div>
                  <div id="password-strength-bar" style="height: 5px; background: #e2e8f0; border-radius: 3px; margin-top: 5px; overflow: hidden;">
                    <div style="height: 100%; width: 0%; background: var(--danger); transition: all 0.3s ease;"></div>
                  </div>
                </div>
                
                <div class="form-group">
                  <label for="register-password-confirm">Şifre Tekrar</label>
                  <input type="password" id="register-password-confirm" class="form-control" placeholder="Şifrenizi tekrar girin">
                </div>
                
                <div style="margin-top: 15px;">
                  <input type="checkbox" id="terms-checkbox" style="margin-right: 5px;">
                  <label for="terms-checkbox" style="font-size: 14px;">
                    <a href="#" style="color: var(--primary); text-decoration: none;">Kullanım şartlarını</a> ve <a href="#" style="color: var(--primary); text-decoration: none;">gizlilik politikasını</a> kabul ediyorum.
                  </label>
                </div>
              </div>
              <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('register-modal')">İptal</button>
                <button class="btn btn-primary" onclick="register()">Kayıt Ol</button>
              </div>
            </div>
          </div>
          
          <!-- Forgot Password Modal -->
          <div class="modal-overlay" id="forgot-password-modal">
            <div class="modal">
              <div class="modal-header">
                <h3>Şifremi Unuttum</h3>
                <button class="modal-close" onclick="closeModal('forgot-password-modal')"><i class="fas fa-times"></i></button>
              </div>
              <div class="modal-body">
                <p style="margin-bottom: 15px;">Şifrenizi sıfırlamak için e-posta adresinizi girin.</p>
                <div class="form-group">
                  <label for="forgot-email">E-posta</label>
                  <input type="email" id="forgot-email" class="form-control" placeholder="E-posta adresiniz">
                </div>
              </div>
              <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeModal('forgot-password-modal')">İptal</button>
                <button class="btn btn-primary" onclick="resetPassword()">Şifremi Sıfırla</button>
              </div>
            </div>
          </div>
          
          <!-- Notification Container -->
          <div id="notifications"></div>
          <script>
            // ===== GLOBAL VARIABLES =====
            let currentTheme = localStorage.getItem('theme') || 'light';
            let currentTab = 'chatbot';
            let draggedTaskId = null;
            let currentExam = 'TYT';
            let currentExamType = 'tyt';
            let currentTipIndex = 0;
            let countdownInterval;
            let currentAdminTab = 'users';
            let isLoggedIn = false;
            let currentUser = null;
            let apiSettings = {
              provider: 'groq',
              model: 'llama3-70b',
              apiKey: '',
              maxTokens: 4096,
              temperature: 0.7
            };
            let systemPrompts = {};
            let currentPlannerId = null;
            let planners = [];
            let tasks = [
              { id: "task1", title: "Matematik", subject: "math", day: 1, hour: 10, duration: 1 },
              { id: "task2", title: "Fizik", subject: "physics", day: 2, hour: 11, duration: 1 },
              { id: "task3", title: "İngilizce", subject: "english", day: 3, hour: 14, duration: 1 }
            ];
            
            // Exam dates
            const examDates = {
              TYT: new Date("June 15, 2025 10:00:00"),
              AYT: new Date("June 16, 2025 10:00:00")
            };
            
            // Exam tips
            const examTips = {
              TYT: [
                "TYT sınavında zaman yönetimi çok önemlidir. Her bölüm için sürenizi önceden planlayın.",
                "Paragraf sorularında önce soruları okuyup sonra metni okumak zaman kazandırabilir.",
                "Matematik bölümünde işlem hatası yapmamak için dikkatli olun ve çözümlerinizi kontrol edin.",
                "Sınav öncesi gün rahat olun, son dakika çalışmalar yerine bildiklerinizi gözden geçirin."
              ],
              AYT: [
                "AYT'de alan bilgisi derinliği önemlidir. Konuları yüzeysel değil, detaylı çalışın.",
                "Sayısal bölümde formülleri ezberlemek yerine, mantığını anlamaya çalışın.",
                "Sözel bölümde güncel olayları takip etmek, bazı sorularda avantaj sağlayabilir.",
                "Sınav stratejinizi önceden belirleyin: Hangi derslere ne kadar zaman ayıracaksınız?"
              ]
            };
            
            // Default prompts for different subjects
            const defaultPrompts = {
              default: "Sen bir eğitim asistanısın. Öğrencilere derslerinde yardımcı olmak, sorularını cevaplamak ve konuları anlaşılır bir şekilde açıklamak için varsın. Öğrencilerin seviyelerine uygun, açık ve anlaşılır bir dil kullanmalısın. Verdiğin bilgiler doğru ve güncel olmalı. Öğrencilerin sorularını sabırla yanıtlamalı ve onları düşünmeye teşvik etmelisin.",
              math: "Sen bir matematik eğitim asistanısın. Öğrencilere matematik derslerinde yardımcı olmak, sorularını cevaplamak ve konuları anlaşılır bir şekilde açıklamak için varsın. Matematiksel kavramları basit ve anlaşılır bir şekilde açıklamalısın. Çözüm yollarını adım adım göstermelisin. Öğrencilerin matematiksel düşünme becerilerini geliştirmelerine yardımcı olmalısın.",
              physics: "Sen bir fizik eğitim asistanısın. Öğrencilere fizik derslerinde yardımcı olmak, sorularını cevaplamak ve konuları anlaşılır bir şekilde açıklamak için varsın. Fizik kavramlarını günlük hayattan örneklerle açıklamalısın. Formüllerin ne anlama geldiğini ve nasıl kullanılacağını öğretmelisin. Öğrencilerin fizik problemlerini çözme becerilerini geliştirmelerine yardımcı olmalısın.",
              literature: "Sen bir edebiyat eğitim asistanısın. Öğrencilere edebiyat derslerinde yardımcı olmak, sorularını cevaplamak ve konuları anlaşılır bir şekilde açıklamak için varsın. Edebi metinleri analiz etme, yorumlama ve değerlendirme becerilerini geliştirmelerine yardımcı olmalısın. Türk ve dünya edebiyatından örnekler vererek konuları zenginleştirmelisin.",
              biology: "Sen bir biyoloji eğitim asistanısın. Öğrencilere biyoloji derslerinde yardımcı olmak, sorularını cevaplamak ve konuları anlaşılır bir şekilde açıklamak için varsın. Biyolojik kavramları ve süreçleri görselleştirerek açıklamalısın. Canlıların yapısını, işlevlerini ve etkileşimlerini anlaşılır bir şekilde anlatmalısın.",
              chemistry: "Sen bir kimya eğitim asistanısın. Öğrencilere kimya derslerinde yardımcı olmak, sorularını cevaplamak ve konuları anlaşılır bir şekilde açıklamak için varsın. Kimyasal reaksiyonları, bileşikleri ve elementleri anlaşılır bir şekilde açıklamalısın. Kimya problemlerini çözme stratejilerini öğretmelisin.",
              history: "Sen bir tarih eğitim asistanısın. Öğrencilere tarih derslerinde yardımcı olmak, sorularını cevaplamak ve konuları anlaşılır bir şekilde açıklamak için varsın. Tarihsel olayları kronolojik sırayla ve neden-sonuç ilişkisi içinde anlatmalısın. Tarihsel kaynakları analiz etme ve değerlendirme becerilerini geliştirmelerine yardımcı olmalısın.",
              geography: "Sen bir coğrafya eğitim asistanısın. Öğrencilere coğrafya derslerinde yardımcı olmak, sorularını cevaplamak ve konuları anlaşılır bir şekilde açıklamak için varsın. Fiziki ve beşeri coğrafya konularını haritalar ve görsellerle destekleyerek açıklamalısın. Coğrafi olayları ve süreçleri güncel örneklerle ilişkilendirmelisin."
            };
            
            // ===== INITIALIZATION =====
            document.addEventListener('DOMContentLoaded', function() {
              // Set theme
              setTheme(currentTheme);
              
              // Set active tab
              showTab(currentTab);
              
              // Initialize exam countdown
              updateExamCountdown();
              
              // Initialize drag and drop
              initDragAndDrop();
              
              // Initialize admin tabs
              initAdminTabs();
              
              // Load system prompts
              loadSystemPrompts();
              
              // Check if user is logged in from localStorage
              checkLoginStatus();
              
              // Check server health
              checkServerHealth();
              
              // Add event listeners
              document.querySelectorAll('.menu-button').forEach(button => {
                button.addEventListener('click', function() {
                  showTab(this.getAttribute('data-tab'));
                });
              });
              
              document.querySelectorAll('.exam-tabs button').forEach(button => {
                button.addEventListener('click', function() {
                  selectExam(this.getAttribute('data-exam'));
                });
              });
              
              document.querySelectorAll('.exam-type-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                  selectExamType(this.getAttribute('data-exam-type'));
                });
              });
              
              document.querySelectorAll('.suggestion-chip').forEach(chip => {
                chip.addEventListener('click', function() {
                  document.getElementById('chat-input-field').value = this.textContent;
                });
              });
              
              document.getElementById('theme-toggle-btn').addEventListener('click', toggleTheme);
              document.getElementById('mobile-toggle').addEventListener('click', toggleSidebar);
              document.getElementById('dark-mode-toggle').addEventListener('change', function() {
                setTheme(this.checked ? 'dark' : 'light');
              });
              
              document.getElementById('customize-ai-toggle').addEventListener('change', function() {
                document.getElementById('ai-personalization-fields').style.display = this.checked ? 'block' : 'none';
              });
              
              document.querySelectorAll('.color-option').forEach(option => {
                option.addEventListener('click', function() {
                  document.querySelectorAll('.color-option').forEach(opt => opt.classList.remove('active'));
                  this.classList.add('active');
                  // In a real app, this would change the primary color
                });
              });
              
              // Add event listeners for auth buttons
              document.getElementById('login-button').addEventListener('click', showLoginModal);
              document.getElementById('register-button').addEventListener('click', showRegisterModal);
            });
          
            // ===== SERVER HEALTH CHECK =====
            function checkServerHealth() {
              fetch(`${API_URL}/api/health`)
                .then(response => {
                  if (!response.ok) {
                    throw new Error('Server health check failed');
                  }
                  return response.json();
                })
                .then(data => {
                  console.log('Server health:', data);
                  document.getElementById('server-status').textContent = 'Çalışıyor';
                  document.getElementById('server-status-indicator').style.background = 'var(--success)';
                  document.getElementById('server-status-text').textContent = 'Çalışıyor';
                })
                .catch(error => {
                  console.error('Server health check error:', error);
                  document.getElementById('server-status').textContent = 'Bağlantı Hatası';
                  document.getElementById('server-status-indicator').style.background = 'var(--danger)';
                  document.getElementById('server-status-text').textContent = 'Bağlantı Hatası';
                  
                  showNotification({
                    title: 'Sunucu Bağlantı Hatası',
                    message: 'Sunucuya bağlanılamıyor. Bazı özellikler çalışmayabilir.',
                    type: 'error'
                  });
                });
            }
          
            // ===== SYSTEM PROMPTS FUNCTIONS =====
            function loadSystemPrompts() {
              // Try to load from localStorage first
              const savedPrompts = localStorage.getItem('systemPrompts');
              if (savedPrompts) {
                systemPrompts = JSON.parse(savedPrompts);
              } else {
                // Fetch from server if logged in
                if (isLoggedIn) {
                  fetch(`${API_URL}/api/admin/settings`, {
                    headers: {
                      'Authorization': `Bearer ${localStorage.getItem('token')}`
                    }
                  })
                  .then(response => {
                    if (!response.ok) {
                      throw new Error('Failed to load system prompts');
                    }
                    return response.json();
                  })
                  .then(data => {
                    if (data.systemPrompts) {
                      systemPrompts = data.systemPrompts;
                      localStorage.setItem('systemPrompts', JSON.stringify(systemPrompts));
                    } else {
                      // Use default prompts
                      systemPrompts = defaultPrompts;
                      localStorage.setItem('systemPrompts', JSON.stringify(systemPrompts));
                    }
                  })
                  .catch(error => {
                    console.error('Load system prompts error:', error);
                    // Use default prompts
                    systemPrompts = defaultPrompts;
                    localStorage.setItem('systemPrompts', JSON.stringify(systemPrompts));
                  });
                } else {
                  // Use default prompts
                  systemPrompts = defaultPrompts;
                  localStorage.setItem('systemPrompts', JSON.stringify(systemPrompts));
                }
              }
            }
          
            function loadSelectedPrompt() {
              const promptType = document.getElementById('prompt-select').value;
              document.getElementById('prompt-content').value = systemPrompts[promptType] || defaultPrompts[promptType] || '';
            }
          
            function savePrompt() {
              const promptType = document.getElementById('prompt-select').value;
              const promptContent = document.getElementById('prompt-content').value;
              
              if (!promptContent.trim()) {
                showNotification({
                  title: 'Hata',
                  message: 'Prompt içeriği boş olamaz.',
                  type: 'error'
                });
                return;
              }
              
              systemPrompts[promptType] = promptContent;
              localStorage.setItem('systemPrompts', JSON.stringify(systemPrompts));
              
              // If logged in, save to server
              if (isLoggedIn && currentUser.role === 'admin') {
                fetch(`${API_URL}/api/admin/settings`, {
                  method: 'PUT',
                  headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${localStorage.getItem('token')}`
                  },
                  body: JSON.stringify({
                    systemPrompts: systemPrompts
                  })
                })
                .then(response => {
                  if (!response.ok) {
                    throw new Error('Failed to save prompt');
                  }
                  return response.json();
                })
                .then(data => {
                  showNotification({
                    title: 'Başarılı',
                    message: 'Prompt başarıyla kaydedildi.',
                    type: 'success'
                  });
                  
                  // Add to logs
                  addSystemLog('INFO', `Sistem promptu güncellendi: ${promptType}`);
                })
                .catch(error => {
                  console.error('Save prompt error:', error);
                  showNotification({
                    title: 'Hata',
                    message: 'Prompt kaydedilirken bir hata oluştu.',
                    type: 'error'
                  });
                });
              } else {
                showNotification({
                  title: 'Başarılı',
                  message: 'Prompt başarıyla kaydedildi.',
                  type: 'success'
                });
              }
            }
          
            function resetPrompt() {
              const promptType = document.getElementById('prompt-select').value;
              document.getElementById('prompt-content').value = defaultPrompts[promptType] || '';
            }
            
            // ===== AUTH FUNCTIONS =====
            function checkLoginStatus() {
              const token = localStorage.getItem('token');
              const user = localStorage.getItem('user');
              
              if (token && user) {
                // Token doğrulaması yap
                fetch(`${API_URL}/api/user`, {
                  headers: {
                    'Authorization': `Bearer ${token}`
                  }
                })
                .then(response => {
                  if (!response.ok) {
                    throw new Error('Token geçersiz');
                  }
                  return response.json();
                })
                .then(data => {
                  isLoggedIn = true;
                  currentUser = data;
                  localStorage.setItem('user', JSON.stringify(currentUser));
                  updateUIForLoggedInUser();
                })
                .catch(error => {
                  console.error('Token validation error:', error);
                  // Token geçersizse çıkış yap
                  logout(false);
                });
              }
            }
            
            function updateUIForLoggedInUser() {
              // Update auth buttons
              document.querySelector('.auth-buttons').innerHTML = `
                <button onclick="showUserProfile()">
                  <i class="fas fa-user"></i> ${currentUser.username}
                </button>
                <button onclick="logout()">Çıkış Yap</button>
              `;
              
              // Update user profile in sidebar
              const userProfile = document.querySelector('.user-profile');
              const avatar = userProfile.querySelector('.avatar');
              const name = userProfile.querySelector('.name');
              const role = userProfile.querySelector('.role');
              
              avatar.textContent = getInitials(currentUser.username);
              name.textContent = currentUser.username;
              role.textContent = currentUser.role === 'admin' ? 'Admin' : 'Öğrenci';
              
              // Show admin panel button if user is admin
              if (currentUser.role === 'admin') {
                document.getElementById('admin-menu-button').style.display = 'flex';
                // Load admin data
                loadAdminData();
              } else {
                document.getElementById('admin-menu-button').style.display = 'none';
              }
          
              // Load user's planners
              loadUserPlanners();
              
              // Load chat history
              loadChatHistory();
            }
            
            function getInitials(name) {
              if (!name) return 'U';
              return name.split(' ').map(n => n[0]).join('').toUpperCase();
            }
            
            function showLoginModal() {
              document.getElementById('login-modal').classList.add('show');
            }
            
            function showRegisterModal() {
              document.getElementById('register-modal').classList.add('show');
            }
            
            function showForgotPasswordModal() {
              closeModal('login-modal');
              document.getElementById('forgot-password-modal').classList.add('show');
            }
            
            function togglePasswordVisibility(inputId) {
              const passwordInput = document.getElementById(inputId);
              const toggleIcon = document.getElementById(`${inputId}-toggle`);
              
              if (passwordInput.type === 'password') {
                passwordInput.type = 'text';
                toggleIcon.className = 'fas fa-eye-slash';
              } else {
                passwordInput.type = 'password';
                toggleIcon.className = 'fas fa-eye';
              }
            }
            
            function checkPasswordStrength() {
              const password = document.getElementById('register-password').value;
              const strengthBar = document.querySelector('#password-strength-bar div');
              const strengthText = document.querySelector('#password-strength span');
              
              let strength = 0;
              
              if (password.length >= 8) strength += 25;
              if (password.match(/[a-z]+/)) strength += 25;
              if (password.match(/[A-Z]+/)) strength += 25;
              if (password.match(/[0-9]+/)) strength += 25;
              
              strengthBar.style.width = `${strength}%`;
              
              if (strength <= 25) {
                strengthBar.style.background = 'var(--danger)';
                strengthText.textContent = 'Zayıf';
                strengthText.style.color = 'var(--danger)';
              } else if (strength <= 50) {
                strengthBar.style.background = 'var(--warning)';
                strengthText.textContent = 'Orta';
                strengthText.style.color = 'var(--warning)';
              } else if (strength <= 75) {
                strengthBar.style.background = 'var(--primary)';
                strengthText.textContent = 'İyi';
                strengthText.style.color = 'var(--primary)';
              } else {
                strengthBar.style.background = 'var(--success)';
                strengthText.textContent = 'Güçlü';
                strengthText.style.color = 'var(--success)';
              }
            }
            
            function login() {
              const email = document.getElementById('login-email').value;
              const password = document.getElementById('login-password').value;
              
              if (!email || !password) {
                showNotification({
                  title: 'Hata',
                  message: 'Lütfen tüm alanları doldurun.',
                  type: 'error'
                });
                return;
              }
              
              // API'ye istek gönder
              fetch(`${API_URL}/api/login`, {
                method: 'POST',
                headers: {
                  'Content-Type': 'application/json'
                },
                body: JSON.stringify({ email, password })
              })
              .then(response => {
                if (!response.ok) {
                  throw new Error('Giriş başarısız');
                }
                return response.json();
              })
              .then(data => {
                isLoggedIn = true;
                currentUser = data.user;
                
                // Save to localStorage
                localStorage.setItem('token', data.token);
                localStorage.setItem('user', JSON.stringify(data.user));
                
                // Update UI
                updateUIForLoggedInUser();
                
                // Close modal
                closeModal('login-modal');
                
                // Show notification
                showNotification({
                  title: 'Başarılı',
                  message: 'Giriş başarılı! Hoş geldiniz.',
                  type: 'success'
                });
              })
              .catch(error => {
                console.error('Login error:', error);
                
                // Demo login for testing if server is not available
                if (email === 'admin@ebfl.ai' && password === 'admin123') {
                  const userData = {
                    id: 1,
                    username: 'Admin',
                    email: 'admin@ebfl.ai',
                    role: 'admin'
                  };
                  
                  isLoggedIn = true;
                  currentUser = userData;
                  
                  // Save to localStorage
                  localStorage.setItem('token', 'demo-admin-token');
                  localStorage.setItem('user', JSON.stringify(userData));
                  
                  // Update UI
                  updateUIForLoggedInUser();
                  
                  // Close modal
                  closeModal('login-modal');
                  
                  // Show notification
                  showNotification({
                    title: 'Başarılı',
                    message: 'Admin olarak giriş yaptınız.',
                    type: 'success'
                  });
                  return;
                }
                
                showNotification({
                  title: 'Hata',
                  message: 'Giriş başarısız. Lütfen e-posta ve şifrenizi kontrol edin.',
                  type: 'error'
                });
              });
            }
            
            function register() {
              const name = document.getElementById('register-name').value;
              const surname = document.getElementById('register-surname').value;
              const email = document.getElementById('register-email').value;
              const password = document.getElementById('register-password').value;
              const passwordConfirm = document.getElementById('register-password-confirm').value;
              const termsAccepted = document.getElementById('terms-checkbox').checked;
              
              if (!name || !surname || !email || !password || !passwordConfirm) {
                showNotification({
                  title: 'Hata',
                  message: 'Lütfen tüm alanları doldurun.',
                  type: 'error'
                });
                return;
              }
              
              if (password !== passwordConfirm) {
                showNotification({
                  title: 'Hata',
                  message: 'Şifreler eşleşmiyor.',
                  type: 'error'
                });
                return;
              }
              
              if (!termsAccepted) {
                showNotification({
                  title: 'Hata',
                  message: 'Kullanım şartlarını ve gizlilik politikasını kabul etmelisiniz.',
                  type: 'error'
                });
                return;
              }
              
              // API'ye istek gönder
              fetch(`${API_URL}/api/register`, {
                method: 'POST',
                headers: {
                  'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                  username: `${name} ${surname}`,
                  email,
                  password
                })
              })
              .then(response => {
                if (!response.ok) {
                  throw new Error('Kayıt başarısız');
                }
                return response.json();
              })
              .then(data => {
                closeModal('register-modal');
                
                showNotification({
                  title: 'Başarılı',
                  message: 'Kayıt başarılı! Giriş yapabilirsiniz.',
                  type: 'success'
                });
                
                // Show login modal
                setTimeout(() => {
                  showLoginModal();
                }, 1500);
              })
              .catch(error => {
                console.error('Register error:', error);
                showNotification({
                  title: 'Hata',
                  message: 'Kayıt başarısız. Bu e-posta adresi zaten kullanılıyor olabilir.',
                  type: 'error'
                });
              });
            }
            
            function resetPassword() {
              const email = document.getElementById('forgot-email').value;
              
              if (!email) {
                showNotification({
                  title: 'Hata',
                  message: 'Lütfen e-posta adresinizi girin.',
                  type: 'error'
                });
                return;
              }
              
              // API'ye istek gönder
              fetch(`${API_URL}/api/reset-password`, {
                method: 'POST',
                headers: {
                  'Content-Type': 'application/json'
                },
                body: JSON.stringify({ email })
              })
              .then(response => {
                if (!response.ok) {
                  throw new Error('Şifre sıfırlama başarısız');
                }
                return response.json();
              })
              .then(data => {
                closeModal('forgot-password-modal');
                
                showNotification({
                  title: 'Başarılı',
                  message: 'Şifre sıfırlama bağlantısı e-posta adresinize gönderildi.',
                  type: 'success'
                });
              })
              .catch(error => {
                console.error('Reset password error:', error);
                
                // Hata olsa bile kullanıcıya olumlu mesaj göster (güvenlik için)
                closeModal('forgot-password-modal');
                
                showNotification({
                  title: 'Başarılı',
                  message: 'Şifre sıfırlama bağlantısı e-posta adresinize gönderildi.',
                  type: 'success'
                });
              });
            }
            
            function logout(showNotificationFlag = true) {
              // Clear user data
              isLoggedIn = false;
              currentUser = null;
              localStorage.removeItem('token');
              localStorage.removeItem('user');
              
              // Update UI
              document.querySelector('.auth-buttons').innerHTML = `
                <button id="login-button">Giriş Yap</button>
                <button id="register-button">Kayıt Ol</button>
              `;
              
              // Update user profile in sidebar
              const userProfile = document.querySelector('.user-profile');
              const avatar = userProfile.querySelector('.avatar');
              const name = userProfile.querySelector('.name');
              const role = userProfile.querySelector('.role');
              
              avatar.textContent = 'U';
              name.textContent = 'Kullanıcı';
              role.textContent = 'Öğrenci';
              
              // Hide admin panel button
              document.getElementById('admin-menu-button').style.display = 'none';
              
              // If on admin tab, switch to chatbot
              if (currentTab === 'admin') {
                showTab('chatbot');
              }
              
              // Add event listeners for auth buttons again
              document.getElementById('login-button').addEventListener('click', showLoginModal);
              document.getElementById('register-button').addEventListener('click', showRegisterModal);
              
              // Clear chat history
              document.getElementById('chat-history-items').innerHTML = `
                <div class="chat-item">
                  <i class="fas fa-history"></i>
                  <span>Yapay Zeka Eğitim Platformu</span>
                </div>
              `;
              
              // Show notification
              if (showNotificationFlag) {
                showNotification({
                  title: 'Başarılı',
                  message: 'Çıkış yapıldı.',
                  type: 'success'
                });
              }
            }
            
            function showUserProfile() {
              if (!isLoggedIn) {
                showNotification({
                  title: 'Hata',
                  message: 'Profil bilgilerinizi görüntülemek için giriş yapmalısınız.',
                  type: 'error'
                });
                return;
              }
              
              // Profil sayfasına yönlendir veya profil modalı göster
              showNotification({
                title: 'Profil',
                message: 'Bu özellik henüz geliştirme aşamasındadır.',
                type: 'info'
              });
            }
            
            function loadChatHistory() {
              if (!isLoggedIn) return;
              
              // API'den sohbet geçmişini al
              fetch(`${API_URL}/api/chat/history`, {
                headers: {
                  'Authorization': `Bearer ${localStorage.getItem('token')}`
                }
              })
              .then(response => {
                if (!response.ok) {
                  throw new Error('Sohbet geçmişi alınamadı');
                }
                return response.json();
              })
              .then(data => {
                const chatHistoryItems = document.getElementById('chat-history-items');
                chatHistoryItems.innerHTML = '';
                
                if (data.length === 0) {
                  chatHistoryItems.innerHTML = `
                    <div class="chat-item">
                      <i class="fas fa-history"></i>
                      <span>Henüz sohbet geçmişi yok</span>
                    </div>
                  `;
                  return;
                }
                
                // Son 5 sohbeti göster
                data.slice(0, 5).forEach(chat => {
                  const chatItem = document.createElement('div');
                  chatItem.className = 'chat-item';
                  chatItem.innerHTML = `
                    <i class="fas fa-history"></i>
                    <span>${chat.message.substring(0, 25)}${chat.message.length > 25 ? '...' : ''}</span>
                  `;
                  
                  // Sohbete tıklandığında sohbeti yükle
                  chatItem.addEventListener('click', () => {
                    // Sohbeti yükle
                    const chatBody = document.getElementById('chat-body');
                    chatBody.innerHTML = '';
                    
                    // Kullanıcı mesajını ekle
                    addMessage(chat.message, 'user');
                    
                    // Asistan yanıtını ekle
                    addMessage(chat.response, 'assistant');
                    
                    // Chatbot tabına geç
                    showTab('chatbot');
                  });
                  
                  chatHistoryItems.appendChild(chatItem);
                });
              })
              .catch(error => {
                console.error('Load chat history error:', error);
                
                // Hata durumunda varsayılan mesaj göster
                document.getElementById('chat-history-items').innerHTML = `
                  <div class="chat-item">
                    <i class="fas fa-history"></i>
                    <span>Sohbet geçmişi yüklenemedi</span>
                  </div>
                `;
              });
            }
            
            // ===== TAB FUNCTIONS =====
            function showTab(tab) {
              // Check if admin tab is selected but user is not admin
              if (tab === 'admin' && (!isLoggedIn || (currentUser && currentUser.role !== 'admin'))) {
                showNotification({
                  title: 'Erişim Reddedildi',
                  message: 'Bu sayfaya erişmek için admin yetkisine sahip olmalısınız.',
                  type: 'error'
                });
                return;
              }
              
              // Update active tab
              currentTab = tab;
              
              // Update menu buttons
              document.querySelectorAll('.menu-button').forEach(button => {
                button.classList.remove('active');
              });
              document.querySelector(`.menu-button[data-tab="${tab}"]`).classList.add('active');
              
              // Update tab content
              document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
              });
              document.getElementById(tab).classList.add('active');
              
              // Update header title
              const titleMap = {
                'chatbot': 'Yapay Zeka Asistanı',
                'planner': 'AI Destekli Ders Programı',
                'timer': 'Sınav Sayacı',
                'score': 'Sınav Puan Hesaplama',
                'settings': 'Ayarlar',
                'admin': 'Admin Paneli'
              };
              
              const iconMap = {
                'chatbot': 'fa-robot',
                'planner': 'fa-calendar-alt',
                'timer': 'fa-stopwatch',
                'score': 'fa-calculator',
                'settings': 'fa-cog',
                'admin': 'fa-user-shield'
              };
              
              document.querySelector('.header-bar .title').innerHTML = `<i class="fas ${iconMap[tab]}"></i> ${titleMap[tab]}`;
              
              // Close sidebar on mobile
              if (window.innerWidth < 768) {
                document.getElementById('sidebar').classList.remove('show');
              }
            }
            
            // ===== THEME FUNCTIONS =====
            function setTheme(theme) {
              currentTheme = theme;
              document.body.setAttribute('data-theme', theme);
              localStorage.setItem('theme', theme);
              
              // Update theme icon
              const themeIcon = document.getElementById('theme-icon');
              themeIcon.className = theme === 'dark' ? 'fas fa-sun' : 'fas fa-moon';
              
              // Update theme toggle in settings
              document.getElementById('dark-mode-toggle').checked = theme === 'dark';
            }
            
            function toggleTheme() {
              const newTheme = currentTheme === 'light' ? 'dark' : 'light';
              setTheme(newTheme);
            }
            
            function toggleSidebar() {
              document.getElementById('sidebar').classList.toggle('show');
            }
            
            // ===== CHATBOT FUNCTIONS =====
            function sendMessage() {
              const inputField = document.getElementById('chat-input-field');
              const message = inputField.value.trim();
              
              if (!message) return;
              
              // Add user message
              addMessage(message, 'user');
              
              // Clear input
              inputField.value = '';
              
              // Show typing indicator
              showTypingIndicator();
              
              // Get AI response
              getAIResponse(message)
                .then(response => {
                  removeTypingIndicator();
                  addMessage(response, 'assistant');
                  
                  // Save chat to database if user is logged in
                  if (isLoggedIn) {
                    saveChatMessage(message, response);
                  }
                })
                .catch(error => {
                  removeTypingIndicator();
                  showNotification({
                    title: 'Hata',
                    message: 'AI yanıtı alınamadı. Lütfen tekrar deneyin.',
                    type: 'error'
                  });
                  console.error('AI response error:', error);
                });
            }
            
            function addMessage(content, sender) {
              const chatBody = document.getElementById('chat-body');
              const messageDiv = document.createElement('div');
              messageDiv.className = `message ${sender}`;
              messageDiv.textContent = content;
              
              if (sender === 'assistant') {
                const actionsDiv = document.createElement('div');
                actionsDiv.className = 'message-actions';
                
                const usefulBtn = document.createElement('button');
                usefulBtn.className = 'message-action';
                usefulBtn.innerHTML = '<i class="fas fa-thumbs-up"></i> Yararlı';
                usefulBtn.onclick = function() {
                  showNotification({
                    title: 'Geri bildirim alındı',
                    message: 'Yanıtı yararlı bulduğunuz için teşekkürler!',
                    type: 'info'
                  });
                };
                
                const replyBtn = document.createElement('button');
                replyBtn.className = 'message-action';
                replyBtn.innerHTML = '<i class="fas fa-reply"></i> Yanıtla';
                replyBtn.onclick = function() {
                  document.getElementById('chat-input-field').value = `"${content.substring(0, 20)}..." adlı cevabınıza karşılık olarak: `;
                  document.getElementById('chat-input-field').focus();
                };
                
                actionsDiv.appendChild(usefulBtn);
                actionsDiv.appendChild(replyBtn);
                messageDiv.appendChild(actionsDiv);
              }
              
              chatBody.appendChild(messageDiv);
              
              // Remove suggestions after first user message
              if (sender === 'user' && document.querySelector('.suggestions')) {
                const suggestions = document.querySelector('.suggestions');
                if (suggestions) {
                  suggestions.remove();
                }
              }
              
              // Scroll to bottom
              chatBody.scrollTop = chatBody.scrollHeight;
            }
            
            function showTypingIndicator() {
              const chatBody = document.getElementById('chat-body');
              const typingDiv = document.createElement('div');
              typingDiv.className = 'message assistant typing-indicator';
              typingDiv.id = 'typing-indicator';
              
              const loadingDots = document.createElement('div');
              loadingDots.className = 'loading-dots';
              
              for (let i = 0; i < 3; i++) {
                const dot = document.createElement('div');
                dot.className = 'loading-dot';
                loadingDots.appendChild(dot);
              }
              
              typingDiv.appendChild(loadingDots);
              chatBody.appendChild(typingDiv);
              chatBody.scrollTop = chatBody.scrollHeight;
            }
            
            function removeTypingIndicator() {
              const typingIndicator = document.getElementById('typing-indicator');
              if (typingIndicator) {
                typingIndicator.remove();
              }
            }
            
            async function getAIResponse(message) {
              // Check if AI is personalized
              const isPersonalized = document.getElementById('customize-ai-toggle').checked;
              let customData = {};
              
              if (isPersonalized) {
                const grade = document.getElementById('grade-select').value;
                const subject = document.getElementById('subject-select').value;
                customData = { grade, subject };
              }
              
              try {
                // API'ye istek gönder
                const response = await fetch(`${API_URL}/api/chat`, {
                  method: 'POST',
                  headers: {
                    'Content-Type': 'application/json',
                    'Authorization': isLoggedIn ? `Bearer ${localStorage.getItem('token')}` : ''
                  },
                  body: JSON.stringify({
                    message,
                    customData,
                    token: isLoggedIn ? localStorage.getItem('token') : null
                  })
                });
                
                if (!response.ok) {
                  throw new Error('AI API error');
                }
                
                const data = await response.json();
                return data.response;
              } catch (error) {
                console.error('AI API error:', error);
                
                // Sunucu hatası durumunda basit yanıtlar
                if (message.toLowerCase().includes('matematik')) {
                  return "Matematik konusunda size yardımcı olabilirim. Hangi konuda zorlanıyorsunuz? Örneğin: fonksiyonlar, türev, integral, olasılık gibi konularda detaylı açıklamalar yapabilirim.";
                } else if (message.toLowerCase().includes('fizik')) {
                  return "Fizik dersinde hangi konuda yardıma ihtiyacınız var? Mekanik, elektrik, manyetizma, optik gibi konularda size destek olabilirim.";
                } else if (message.toLowerCase().includes('tyt') || message.toLowerCase().includes('ayt') || message.toLowerCase().includes('sınav')) {
                  return "Sınava hazırlık sürecinizde size yardımcı olabilirim. Düzenli çalışma programı, konu tekrarı ve soru çözümü için stratejiler geliştirebiliriz. Hangi derslerde desteğe ihtiyacınız var?";
                }
                
                // Varsayılan yanıt
                return "Bu konuda size yardımcı olabilirim. Daha spesifik bir soru sorarsanız daha detaylı bilgi verebilirim. Hangi konuda desteğe ihtiyacınız var?";
              }
            }
            
            function saveChatMessage(message, response) {
              // API'ye istek gönder
              fetch(`${API_URL}/api/chat`, {
                method: 'POST',
                headers: {
                  'Content-Type': 'application/json',
                  'Authorization': `Bearer ${localStorage.getItem('token')}`
                },
                body: JSON.stringify({ message, response })
              })
              .then(response => {
                if (!response.ok) {
                  throw new Error('Save chat error');
                }
                return response.json();
              })
              .then(data => {
                console.log('Chat saved:', data);
                
                // Sohbet geçmişini güncelle
                loadChatHistory();
              })
              .catch(error => {
                console.error('Save chat error:', error);
              });
            }
            
            // ===== EXAM COUNTDOWN FUNCTIONS =====
            function updateExamCountdown() {
              const now = new Date();
              const examDate = examDates[currentExam];
              const diff = examDate - now;
              
              if (diff > 0) {
                const days = Math.floor(diff / (1000 * 60 * 60 * 24));
                const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((diff % (1000 * 60)) / 1000);
                
                document.getElementById('days').textContent = days.toString().padStart(2, '0');
                document.getElementById('hours').textContent = hours.toString().padStart(2, '0');
                document.getElementById('minutes').textContent = minutes.toString().padStart(2, '0');
                document.getElementById('seconds').textContent = seconds.toString().padStart(2, '0');
              } else {
                document.getElementById('days').textContent = '00';
                document.getElementById('hours').textContent = '00';
                document.getElementById('minutes').textContent = '00';
                document.getElementById('seconds').textContent = '00';
              }
              
              // Update countdown every second
              clearInterval(countdownInterval);
              countdownInterval = setInterval(updateExamCountdown, 1000);
            }
            
            function selectExam(exam) {
              currentExam = exam;
              
              // Update active button
              document.querySelectorAll('.exam-tabs button').forEach(button => {
                button.classList.remove('active');
              });
              document.querySelector(`.exam-tabs button[data-exam="${exam}"]`).classList.add('active');
              
              // Update countdown title
              document.querySelector('.countdown-title').textContent = `${exam} sınavına kalan süre:`;
              
              // Update exam tip
              document.getElementById('exam-tip').textContent = examTips[exam][0];
              currentTipIndex = 0;
              
              // Update countdown
              updateExamCountdown();
            }
            
            function showNextTip() {
              currentTipIndex = (currentTipIndex + 1) % examTips[currentExam].length;
              document.getElementById('exam-tip').textContent = examTips[currentExam][currentTipIndex];
            }
            
            // ===== PLANNER FUNCTIONS =====
            function initDragAndDrop() {
              const dropZones = document.querySelectorAll('.schedule-cell');
              
              // Tüm hücrelere drop event listener ekle
              dropZones.forEach(zone => {
                zone.addEventListener('dragover', function(e) {
                  e.preventDefault();
                  this.classList.add('drag-over');
                });
                
                zone.addEventListener('dragleave', function() {
                  this.classList.remove('drag-over');
                });
                
                zone.addEventListener('drop', function(e) {
                  e.preventDefault();
                  this.classList.remove('drag-over');
                  
                  if (draggedTaskId) {
                    const day = parseInt(this.getAttribute('data-day'));
                    const hour = parseInt(this.getAttribute('data-hour'));
                    
                    // Update task data
                    const taskIndex = tasks.findIndex(task => task.id === draggedTaskId);
                    if (taskIndex !== -1) {
                      tasks[taskIndex].day = day;
                      tasks[taskIndex].hour = hour;
                      
                      // Update UI
                      renderTasks();
                      updateTotalStudyHours();
                      updateUpcomingClasses();
                      
                      // Show notification
                      showNotification({
                        title: 'Ders Programı Güncellendi',
                        message: `${tasks[taskIndex].title} dersi ${getDayName(day)} günü saat ${hour}:00'a taşındı.`,
                        type: 'success'
                      });
                    }
                    
                    draggedTaskId = null;
                  }
                });
              });
            }
            
            function renderTasks() {
              // Clear all tasks from UI
              document.querySelectorAll('.task').forEach(task => task.remove());
              
              // Render tasks
              tasks.forEach(task => {
                const cell = document.querySelector(`.schedule-cell[data-day="${task.day}"][data-hour="${task.hour}"]`);
                if (cell) {
                  const taskElement = document.createElement('div');
                  taskElement.className = `task ${task.subject}`;
                  taskElement.setAttribute('draggable', 'true');
                  taskElement.setAttribute('data-task-id', task.id);
                  
                  const titleElement = document.createElement('div');
                  titleElement.className = 'task-title';
                  titleElement.textContent = task.title;
                  
                  const timeElement = document.createElement('div');
                  timeElement.className = 'task-time';
                  timeElement.textContent = `${task.hour}:00 - ${task.hour + task.duration}:00`;
                  
                  taskElement.appendChild(titleElement);
                  taskElement.appendChild(timeElement);
                  cell.appendChild(taskElement);
                  
                  // Add event listeners
                  taskElement.addEventListener('dragstart', function() {
                    draggedTaskId = this.getAttribute('data-task-id');
                    setTimeout(() => this.classList.add('dragging'), 0);
                  });
                  
                  taskElement.addEventListener('dragend', function() {
                    this.classList.remove('dragging');
                  });
                }
              });
            }
            
            function getDayName(day) {
              const days = ['', 'Pazartesi', 'Salı', 'Çarşamba', 'Perşembe', 'Cuma', 'Cumartesi', 'Pazar'];
              return days[day];
            }
            
            function showAddTaskModal() {
              if (!isLoggedIn) {
                showNotification({
                  title: 'Giriş Gerekli',
                  message: 'Ders eklemek için giriş yapmalısınız.',
                  type: 'warning'
                });
                return;
              }
              
              if (!currentPlannerId) {
                showNotification({
                  title: 'Hata',
                  message: 'Lütfen önce bir ders programı seçin veya oluşturun.',
                  type: 'error'
                });
                return;
              }
              
              document.getElementById('add-task-modal').classList.add('show');
            }
            
            function showNewPlannerModal() {
              if (!isLoggedIn) {
                showNotification({
                  title: 'Giriş Gerekli',
                  message: 'Ders programı oluşturmak için giriş yapmalısınız.',
                  type: 'warning'
                });
                return;
              }
              
              document.getElementById('new-planner-modal').classList.add('show');
            }
            
            function showPlannerSettings() {
              showNotification({
                title: 'Ders Programı Ayarları',
                message: 'Bu özellik henüz geliştirme aşamasındadır.',
                type: 'info'
              });
            }
            
            function addTask() {
              const title = document.getElementById('task-title').value;
              const subject = document.getElementById('task-subject').value;
              const day = parseInt(document.getElementById('task-day').value);
              const hour = parseInt(document.getElementById('task-hour').value);
              const duration = parseInt(document.getElementById('task-duration').value);
              
              if (!title || !subject) {
                showNotification({
                  title: 'Hata',
                  message: 'Lütfen tüm alanları doldurun.',
                  type: 'error'
                });
                return;
              }
              
              // Check if the time slot is available
              const conflictingTask = tasks.find(task => 
                task.day === day && 
                ((task.hour <= hour && task.hour + task.duration > hour) || 
                 (hour <= task.hour && hour + duration > task.hour))
              );
              
              if (conflictingTask) {
                showNotification({
                  title: 'Çakışma',
                  message: 'Bu zaman diliminde başka bir ders bulunuyor.',
                  type: 'warning'
                });
                return;
              }
              
              // API'ye istek gönder
              fetch(`${API_URL}/api/study-plans/${currentPlannerId}/tasks`, {
                method: 'POST',
                headers: {
                  'Content-Type': 'application/json',
                  'Authorization': `Bearer ${localStorage.getItem('token')}`
                },
                body: JSON.stringify({
                  title,
                  subject,
                  day,
                  hour,
                  duration
                })
              })
              .then(response => {
                if (!response.ok) {
                  throw new Error('Add task error');
                }
                return response.json();
              })
              .then(data => {
                // Add new task
                const newTask = {
                  id: `task${data.taskId}`,
                  title,
                  subject,
                  day,
                  hour,
                  duration
                };
                
                tasks.push(newTask);
                
                // Update UI
                renderTasks();
                updateTotalStudyHours();
                updateUpcomingClasses();
                
                // Close modal
                closeModal('add-task-modal');
                
                // Show notification
                showNotification({
                  title: 'Ders Eklendi',
                  message: `${title} dersi ${getDayName(day)} günü saat ${hour}:00'a eklendi.`,
                  type: 'success'
                });
                
                // Reset form
                document.getElementById('task-title').value = '';
                document.getElementById('task-subject').value = '';
              })
              .catch(error => {
                console.error('Add task error:', error);
                showNotification({
                  title: 'Hata',
                  message: 'Ders eklenirken bir hata oluştu.',
                  type: 'error'
                });
              });
            }
            
            function updateTotalStudyHours() {
              const totalHours = tasks.reduce((total, task) => total + task.duration, 0);
              document.getElementById('total-study-hours').textContent = `${totalHours} saat`;
            }
            
            function updateUpcomingClasses() {
              const upcomingClassesElement = document.getElementById('upcoming-classes');
              upcomingClassesElement.innerHTML = '';
              
              // Sort tasks by day and hour
              const sortedTasks = [...tasks].sort((a, b) => {
                if (a.day !== b.day) return a.day - b.day;
                return a.hour - b.hour;
              });
              
              // Take first 3 tasks
              const upcomingTasks = sortedTasks.slice(0, 3);
              
              // Add tasks to UI
              upcomingTasks.forEach(task => {
                const taskElement = document.createElement('div');
                taskElement.style.marginBottom = '8px';
                taskElement.style.display = 'flex';
                taskElement.style.alignItems = 'center';
                taskElement.style.gap = '8px';
                
                const dotElement = document.createElement('div');
                dotElement.style.width = '8px';
                dotElement.style.height = '8px';
                dotElement.style.borderRadius = '50%';
                
                // Set color based on subject
                if (task.subject === 'math') {
                  dotElement.style.background = 'var(--secondary)';
                } else if (task.subject === 'physics') {
                  dotElement.style.background = 'var(--success)';
                } else if (task.subject === 'english') {
                  dotElement.style.background = 'var(--warning)';
                } else {
                  dotElement.style.background = 'var(--primary)';
                }
                
                const textElement = document.createElement('span');
                textElement.textContent = `${task.title} - ${getDayName(task.day)} ${task.hour}:00`;
                
                taskElement.appendChild(dotElement);
                taskElement.appendChild(textElement);
                upcomingClassesElement.appendChild(taskElement);
              });
              
              // If no tasks, show message
              if (upcomingTasks.length === 0) {
                upcomingClassesElement.innerHTML = '<p style="color: #666;">Henüz planlanmış ders bulunmuyor.</p>';
              }
            }
            
            function exportToPDF() {
              if (!isLoggedIn) {
                showNotification({
                  title: 'Giriş Gerekli',
                  message: 'PDF olarak indirmek için giriş yapmalısınız.',
                  type: 'warning'
                });
                return;
              }
              
              // Show loading notification
              showNotification({
                title: 'PDF Hazırlanıyor',
                message: 'Ders programınız PDF olarak hazırlanıyor...',
                type: 'info'
              });
              
              // Get the timetable element
              const timetable = document.querySelector('.timetable');
              
              // Use html2canvas to capture the timetable
              html2canvas(timetable).then(canvas => {
                // Initialize jsPDF
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF('landscape', 'pt', 'a4');
                
                // Add title
                pdf.setFontSize(18);
                pdf.setTextColor(99, 102, 241); // Primary color
                pdf.text('ebfl.ai - Ders Programı', 40, 40);
                
                // Add date
                pdf.setFontSize(12);
                pdf.setTextColor(100, 100, 100);
                const today = new Date();
                pdf.text(`Oluşturulma Tarihi: ${today.toLocaleDateString('tr-TR')}`, 40, 60);
                
                // Add user info if logged in
                if (isLoggedIn && currentUser) {
                  pdf.text(`Kullanıcı: ${currentUser.username}`, 40, 80);
                }
                
                // Add image from canvas
                const imgData = canvas.toDataURL('image/png');
                pdf.addImage(imgData, 'PNG', 40, 100, 760, 400);
                
                // Add footer
                pdf.setFontSize(10);
                pdf.setTextColor(150, 150, 150);
                pdf.text('ebfl.ai tarafından oluşturulmuştur. © 2023 Tüm hakları saklıdır.', 40, 550);
                
                // Save the PDF
                pdf.save('ebfl-ai-ders-programi.pdf');
                
                // Show success notification
                showNotification({
                  title: 'Başarılı',
                  message: 'Ders programınız PDF olarak indirildi.',
                  type: 'success'
                });
              });
            }
            
            function loadUserPlanners() {
              if (!isLoggedIn) return;
              
              // API'den kullanıcının ders programlarını al
              fetch(`${API_URL}/api/study-plans`, {
                headers: {
                  'Authorization': `Bearer ${localStorage.getItem('token')}`
                }
              })
              .then(response => {
                if (!response.ok) {
                  throw new Error('Load planners error');
                }
                return response.json();
              })
              .then(data => {
                planners = data;
                updatePlannerSelect();
              })
              .catch(error => {
                console.error('Load planners error:', error);
              });
            }
            
            function updatePlannerSelect() {
              const plannerSelect = document.getElementById('planner-select');
              
              // Clear options except the first one
              while (plannerSelect.options.length > 1) {
                plannerSelect.remove(1);
              }
              
              // Add planners to select
              planners.forEach(planner => {
                const option = document.createElement('option');
                option.value = planner.id;
                option.textContent = planner.name;
                plannerSelect.appendChild(option);
              });
            }
            
            function loadSelectedPlanner() {
              const plannerId = document.getElementById('planner-select').value;
              
              if (!plannerId) return;
              
              currentPlannerId = plannerId;
              
              // API'den seçilen ders programının görevlerini al
              fetch(`${API_URL}/api/study-plans/${plannerId}/tasks`, {
                headers: {
                  'Authorization': `Bearer ${localStorage.getItem('token')}`
                }
              })
              .then(response => {
                if (!response.ok) {
                  throw new Error('Load planner tasks error');
                }
                return response.json();
              })
              .then(data => {
                tasks = data.map(task => ({
                  id: `task${task.id}`,
                  title: task.title,
                  subject: task.subject,
                  day: task.day,
                  hour: task.hour,
                  duration: task.duration
                }));
                
                renderTasks();
                updateTotalStudyHours();
                updateUpcomingClasses();
              })
              .catch(error => {
                console.error('Load planner tasks error:', error);
              });
            }
            
            function createNewPlanner() {
              const name = document.getElementById('planner-name').value;
              const description = document.getElementById('planner-description').value;
              
              if (!name) {
                showNotification({
                  title: 'Hata',
                  message: 'Lütfen program adını girin.',
                  type: 'error'
                });
                return;
              }
              
              // API'ye istek gönder
              fetch(`${API_URL}/api/study-plans`, {
                method: 'POST',
                headers: {
                  'Content-Type': 'application/json',
                  'Authorization': `Bearer ${localStorage.getItem('token')}`
                },
                body: JSON.stringify({ name, description })
              })
              .then(response => {
                if (!response.ok) {
                  throw new Error('Create planner error');
                }
                return response.json();
              })
              .then(data => {
                // Add new planner to list
                const newPlanner = {
                  id: data.planId,
                  name,
                  description,
                  tasks: []
                };
                
                planners.push(newPlanner);
                
                // Update UI
                updatePlannerSelect();
                
                // Select new planner
                document.getElementById('planner-select').value = data.planId;
                currentPlannerId = data.planId;
                
                // Clear tasks
                tasks = [];
                renderTasks();
                updateTotalStudyHours();
                updateUpcomingClasses();
                
                // Close modal
                closeModal('new-planner-modal');
                
                // Show notification
                showNotification({
                  title: 'Başarılı',
                  message: 'Yeni ders programı oluşturuldu.',
                  type: 'success'
                });
                
                // Reset form
                document.getElementById('planner-name').value = '';
                document.getElementById('planner-description').value = '';
              })
              .catch(error => {
                console.error('Create planner error:', error);
                showNotification({
                  title: 'Hata',
                  message: 'Ders programı oluşturulurken bir hata oluştu.',
                  type: 'error'
                });
              });
            }
            
            function saveCurrentPlanner() {
              if (!currentPlannerId) {
                showNotification({
                  title: 'Hata',
                  message: 'Lütfen önce bir ders programı seçin veya oluşturun.',
                  type: 'error'
                });
                return;
              }
              
              // API'ye istek gönder
              // Önce tüm görevleri sil
              fetch(`${API_URL}/api/study-plans/${currentPlannerId}/tasks`, {
                method: 'DELETE',
                headers: {
                  'Authorization': `Bearer ${localStorage.getItem('token')}`
                }
              })
              .then(response => {
                if (!response.ok) {
                  throw new Error('Delete tasks error');
                }
                return response.json();
              })
              .then(() => {
                // Sonra tüm görevleri ekle
                const promises = tasks.map(task => {
                  return fetch(`${API_URL}/api/study-plans/${currentPlannerId}/tasks`, {
                    method: 'POST',
                    headers: {
                      'Content-Type': 'application/json',
                      'Authorization': `Bearer ${localStorage.getItem('token')}`
                    },
                    body: JSON.stringify({
                      title: task.title,
                      subject: task.subject,
                      day: task.day,
                      hour: task.hour,
                      duration: task.duration
                    })
                  });
                });
                
                return Promise.all(promises);
              })
              .then(() => {
                showNotification({
                  title: 'Başarılı',
                  message: 'Ders programı kaydedildi.',
                  type: 'success'
                });
              })
              .catch(error => {
                console.error('Save planner error:', error);
                showNotification({
                  title: 'Hata',
                  message: 'Ders programı kaydedilirken bir hata oluştu.',
                  type: 'error'
                });
              });
            }
            
            // ===== SCORE CALCULATOR FUNCTIONS =====
            function selectExamType(examType) {
              currentExamType = examType;
              
              // Update active tab
              document.querySelectorAll('.exam-type-tab').forEach(tab => {
                tab.classList.remove('active');
              });
              document.querySelector(`.exam-type-tab[data-exam-type="${examType}"]`).classList.add('active');
              
              // TODO: Show different form based on exam type
            }
            
            function calculateScore() {
              // Get input values
              const turkishCorrect = parseInt(document.getElementById('turkishCorrect').value) || 0;
              const turkishWrong = parseInt(document.getElementById('turkishWrong').value) || 0;
              const mathCorrect = parseInt(document.getElementById('mathCorrect').value) || 0;
              const mathWrong = parseInt(document.getElementById('mathWrong').value) || 0;
              const scienceCorrect = parseInt(document.getElementById('scienceCorrect').value) || 0;
              const scienceWrong = parseInt(document.getElementById('scienceWrong').value) || 0;
              const socialCorrect = parseInt(document.getElementById('socialCorrect').value) || 0;
              const socialWrong = parseInt(document.getElementById('socialWrong').value) || 0;
              
              // Calculate nets
              const turkishNet = turkishCorrect - (turkishWrong * 0.25);
              const mathNet = mathCorrect - (mathWrong * 0.25);
              const scienceNet = scienceCorrect - (scienceWrong * 0.25);
              const socialNet = socialCorrect - (socialWrong * 0.25);
              const totalNet = turkishNet + mathNet + scienceNet + socialNet;
              
              // Calculate estimated score (simplified formula)
              const baseScore = 100;
              const estimatedScore = baseScore + (totalNet * 4);
              
              // Update results
              document.getElementById('turkishNet').textContent = turkishNet.toFixed(2);
              document.getElementById('mathNet').textContent = mathNet.toFixed(2);
              document.getElementById('scienceNet').textContent = scienceNet.toFixed(2);
              document.getElementById('socialNet').textContent = socialNet.toFixed(2);
              document.getElementById('totalNet').textContent = totalNet.toFixed(2);
              document.getElementById('estimatedScore').textContent = estimatedScore.toFixed(2);
              
              // Show results
              document.getElementById('results').style.display = 'block';
            }
            
            // ===== SETTINGS FUNCTIONS =====
            function saveSettings() {
              // Get settings values
              const darkMode = document.getElementById('dark-mode-toggle').checked;
              const animations = document.getElementById('animations-toggle').checked;
              const customizeAI = document.getElementById('customize-ai-toggle').checked;
              const grade = document.getElementById('grade-select').value;
              const subject = document.getElementById('subject-select').value;
              const studyReminders = document.getElementById('study-reminders-toggle').checked;
              const examCountdown = document.getElementById('exam-countdown-toggle').checked;
              const aiSuggestions = document.getElementById('ai-suggestions-toggle').checked;
              
              // Save settings to localStorage
              const settings = {
                darkMode,
                animations,
                customizeAI,
                grade,
                subject,
                studyReminders,
                examCountdown,
                aiSuggestions
              };
              
              localStorage.setItem('settings', JSON.stringify(settings));
              
              // Apply settings
              setTheme(darkMode ? 'dark' : 'light');
              
              // Show notification
              showNotification({
                title: 'Başarılı',
                message: 'Ayarlar kaydedildi.',
                type: 'success'
              });
            }
            
            // ===== ADMIN FUNCTIONS =====
            function initAdminTabs() {
              document.querySelectorAll('.admin-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                  const tabId = this.getAttribute('data-admin-tab');
                  selectAdminTab(tabId);
                });
              });
            }
            
            function selectAdminTab(tabId) {
              currentAdminTab = tabId;
              
              // Update active tab
              document.querySelectorAll('.admin-tab').forEach(tab => {
                tab.classList.remove('active');
              });
              document.querySelector(`.admin-tab[data-admin-tab="${tabId}"]`).classList.add('active');
              
              // Update tab content
              document.querySelectorAll('.admin-tab-content').forEach(content => {
                content.classList.remove('active');
              });
              document.getElementById(`admin-${tabId}`).classList.add('active');
            }
            
            function loadAdminData() {
              // Load admin stats
              fetch(`${API_URL}/api/admin/stats`, {
                headers: {
                  'Authorization': `Bearer ${localStorage.getItem('token')}`
                }
              })
              .then(response => {
                if (!response.ok) {
                  throw new Error('Load admin stats error');
                }
                return response.json();
              })
              .then(data => {
                document.getElementById('total-users').textContent = data.totalUsers;
                document.getElementById('active-users').textContent = data.activeUsers;
                document.getElementById('total-messages').textContent = data.totalMessages;
                document.getElementById('server-status').textContent = 'Çalışıyor';
              })
              .catch(error => {
                console.error('Load admin stats error:', error);
              });
              
              // Load users
              fetch(`${API_URL}/api/admin/users`, {
                headers: {
                  'Authorization': `Bearer ${localStorage.getItem('token')}`
                }
              })
              .then(response => {
                if (!response.ok) {
                  throw new Error('Load users error');
                }
                return response.json();
              })
              .then(data => {
                const usersTableBody = document.getElementById('users-table-body');
                usersTableBody.innerHTML = '';
                
                data.forEach(user => {
                  const row = document.createElement('tr');
                  
                  row.innerHTML = `
                    <td>${user.id}</td>
                    <td>${user.username}</td>
                    <td>${user.email}</td>
                    <td>${user.role}</td>
                    <td>${new Date(user.created_at).toLocaleString('tr-TR')}</td>
                    <td>${user.last_login ? new Date(user.last_login).toLocaleString('tr-TR') : '-'}</td>
                    <td class="actions">
                      <button class="action-btn view-btn" onclick="viewUser(${user.id})">Görüntüle</button>
                      <button class="action-btn edit-btn" onclick="editUser(${user.id})">Düzenle</button>
                      <button class="action-btn delete-btn" onclick="deleteUser(${user.id})">Sil</button>
                    </td>
                  `;
                  
                  usersTableBody.appendChild(row);
                });
              })
              .catch(error => {
                console.error('Load users error:', error);
              });
              
              // Load chats
              fetch(`${API_URL}/api/admin/chats`, {
                headers: {
                  'Authorization': `Bearer ${localStorage.getItem('token')}`
                }
              })
              .then(response => {
                if (!response.ok) {
                  throw new Error('Load chats error');
                }
                return response.json();
              })
              .then(data => {
                const chatsTableBody = document.getElementById('chats-table-body');
                chatsTableBody.innerHTML = '';
                
                data.forEach(chat => {
                  const row = document.createElement('tr');
                  
                  row.innerHTML = `
                    <td>${chat.id}</td>
                    <td>${chat.username}</td>
                    <td>${chat.message.substring(0, 30)}...</td>
                    <td>1</td>
                    <td>${new Date(chat.timestamp).toLocaleString('tr-TR')}</td>
                    <td class="actions">
                      <button class="action-btn view-btn" onclick="viewChat(${chat.id})">Görüntüle</button>
                      <button class="action-btn delete-btn" onclick="deleteChat(${chat.id})">Sil</button>
                    </td>
                  `;
                  
                  chatsTableBody.appendChild(row);
                });
              })
              .catch(error => {
                console.error('Load chats error:', error);
              });
              
              // Load system logs
              fetch(`${API_URL}/api/admin/logs`, {
                headers: {
                  'Authorization': `Bearer ${localStorage.getItem('token')}`
                }
              })
              .then(response => {
                if (!response.ok) {
                  throw new Error('Load logs error');
                }
                return response.json();
              })
              .then(data => {
                const systemLogs = document.getElementById('system-logs');
                systemLogs.innerHTML = '';
                
                data.forEach(log => {
                  const logElement = document.createElement('div');
                  logElement.style.marginBottom = '5px';
                  
                  // Format log level
                  let levelClass = '';
                  if (log.level === 'ERROR') {
                    levelClass = 'color: #ef4444;';
                  } else if (log.level === 'WARNING') {
                    levelClass = 'color: #f59e0b;';
                  } else if (log.level === 'INFO') {
                    levelClass = 'color: #3b82f6;';
                  }
                  
                  logElement.innerHTML = `
                    <span style="color: #aaa;">[${new Date(log.timestamp).toLocaleString('tr-TR')}]</span>
                    <span style="${levelClass}">[${log.level}]</span>
                    <span>${log.message}</span>
                  `;
                  
                  systemLogs.appendChild(logElement);
                });
              })
              .catch(error => {
                console.error('Load logs error:', error);
              });
              
              // Load system settings
              fetch(`${API_URL}/api/admin/settings`, {
                headers: {
                  'Authorization': `Bearer ${localStorage.getItem('token')}`
                }
              })
              .then(response => {
                if (!response.ok) {
                  throw new Error('Load settings error');
                }
                return response.json();
              })
              .then(data => {
                document.getElementById('api-provider').value = data.api_provider;
                document.getElementById('api-model').value = data.api_model;
                document.getElementById('api-key').value = data.api_key;
                document.getElementById('max-tokens').value = data.max_tokens;
                document.getElementById('temperature').value = data.temperature;
                
                // Update apiSettings
                apiSettings = {
                  provider: data.api_provider,
                  model: data.api_model,
                  apiKey: data.api_key,
                  maxTokens: data.max_tokens,
                  temperature: data.temperature
                };
              })
              .catch(error => {
                console.error('Load settings error:', error);
              });
            }
            
            function viewUser(userId) {
              showNotification({
                title: 'Kullanıcı Görüntüleme',
                message: `Kullanıcı ID: ${userId} görüntüleniyor.`,
                type: 'info'
              });
            }
            
            function editUser(userId) {
              showNotification({
                title: 'Kullanıcı Düzenleme',
                message: `Kullanıcı ID: ${userId} düzenleniyor.`,
                type: 'info'
              });
            }
            
            function deleteUser(userId) {
              if (confirm(`${userId} ID'li kullanıcıyı silmek istediğinize emin misiniz?`)) {
                fetch(`${API_URL}/api/admin/users/${userId}`, {
                  method: 'DELETE',
                  headers: {
                    'Authorization': `Bearer ${localStorage.getItem('token')}`
                  }
                })
                .then(response => {
                  if (!response.ok) {
                    throw new Error('Delete user error');
                  }
                  return response.json();
                })
                .then(data => {
                  showNotification({
                    title: 'Başarılı',
                    message: 'Kullanıcı başarıyla silindi.',
                    type: 'success'
                  });
                  
                  // Reload admin data
                  loadAdminData();
                })
                .catch(error => {
                  console.error('Delete user error:', error);
                  showNotification({
                    title: 'Hata',
                    message: 'Kullanıcı silinirken bir hata oluştu.',
                    type: 'error'
                  });
                });
              }
            }
            
            function viewChat(chatId) {
              showNotification({
                title: 'Sohbet Görüntüleme',
                message: `Sohbet ID: ${chatId} görüntüleniyor.`,
                type: 'info'
              });
            }
            
            function deleteChat(chatId) {
              if (confirm(`${chatId} ID'li sohbeti silmek istediğinize emin misiniz?`)) {
                fetch(`${API_URL}/api/admin/chats/${chatId}`, {
                  method: 'DELETE',
                  headers: {
                    'Authorization': `Bearer ${localStorage.getItem('token')}`
                  }
                })
                .then(response => {
                  if (!response.ok) {
                    throw new Error('Delete chat error');
                  }
                  return response.json();
                })
                .then(data => {
                  showNotification({
                    title: 'Başarılı',
                    message: 'Sohbet başarıyla silindi.',
                    type: 'success'
                  });
                  
                  // Reload admin data
                  loadAdminData();
                })
                .catch(error => {
                  console.error('Delete chat error:', error);
                  showNotification({
                    title: 'Hata',
                    message: 'Sohbet silinirken bir hata oluştu.',
                    type: 'error'
                  });
                });
              }
            }
            
            function saveAdminSettings() {
              // Get settings values
              const apiProvider = document.getElementById('api-provider').value;
              const apiModel = document.getElementById('api-model').value;
              const apiKey = document.getElementById('api-key').value;
              const maxTokens = parseInt(document.getElementById('max-tokens').value);
              const temperature = parseFloat(document.getElementById('temperature').value);
              
              // Update apiSettings
              apiSettings = {
                provider: apiProvider,
                model: apiModel,
                apiKey: apiKey,
                maxTokens: maxTokens,
                temperature: temperature
              };
              
              // API'ye istek gönder
              fetch(`${API_URL}/api/admin/settings`, {
                method: 'PUT',
                headers: {
                  'Content-Type': 'application/json',
                  'Authorization': `Bearer ${localStorage.getItem('token')}`
                },
                body: JSON.stringify({
                  api_provider: apiProvider,
                  api_model: apiModel,
                  api_key: apiKey,
                  max_tokens: maxTokens,
                  temperature: temperature
                })
              })
              .then(response => {
                if (!response.ok) {
                  throw new Error('Update settings error');
                }
                return response.json();
              })
              .then(data => {
                showNotification({
                  title: 'Başarılı',
                  message: 'Sistem ayarları kaydedildi.',
                  type: 'success'
                });
                
                // Add to logs
                addSystemLog('INFO', `Sistem ayarları güncellendi: ${apiProvider}, ${apiModel}`);
              })
              .catch(error => {
                console.error('Update settings error:', error);
                showNotification({
                  title: 'Hata',
                  message: 'Sistem ayarları kaydedilirken bir hata oluştu.',
                  type: 'error'
                });
              });
            }
            
            function resetAdminSettings() {
              // Reset to default values
              document.getElementById('api-provider').value = 'groq';
              document.getElementById('api-model').value = 'llama3-70b';
              document.getElementById('api-key').value = '';
              document.getElementById('max-tokens').value = '4096';
              document.getElementById('temperature').value = '0.7';
              document.getElementById('server-port').value = '3000';
              document.getElementById('server-timeout').value = '30000';
              
              // Show notification
              showNotification({
                title: 'Başarılı',
                message: 'Sistem ayarları varsayılana sıfırlandı.',
                type: 'success'
              });
            }
            
            function clearLogs() {
              // API'ye istek gönder
              fetch(`${API_URL}/api/admin/logs`, {
                method: 'DELETE',
                headers: {
                  'Authorization': `Bearer ${localStorage.getItem('token')}`
                }
              })
              .then(response => {
                if (!response.ok) {
                  throw new Error('Clear logs error');
                }
                return response.json();
              })
              .then(data => {
                // Clear logs in UI
                document.getElementById('system-logs').innerHTML = '';
                
                // Show notification
                showNotification({
                  title: 'Başarılı',
                  message: 'Sistem logları temizlendi.',
                  type: 'success'
                });
                
                // Add to logs
                addSystemLog('INFO', 'Sistem logları temizlendi');
              })
              .catch(error => {
                console.error('Clear logs error:', error);
                showNotification({
                  title: 'Hata',
                  message: 'Sistem logları temizlenirken bir hata oluştu.',
                  type: 'error'
                });
              });
            }
            
            function downloadLogs() {
              // Get logs from UI
              const logs = document.getElementById('system-logs').innerText;
              
              // Create blob
              const blob = new Blob([logs], { type: 'text/plain' });
              
              // Create download link
              const url = URL.createObjectURL(blob);
              const a = document.createElement('a');
              a.href = url;
              a.download = `ebfl-ai-logs-${new Date().toISOString().slice(0, 10)}.txt`;
              
              // Trigger download
              document.body.appendChild(a);
              a.click();
              
              // Clean up
              document.body.removeChild(a);
              URL.revokeObjectURL(url);
              
              // Show notification
              showNotification({
                title: 'Başarılı',
                message: 'Sistem logları indirildi.',
                type: 'success'
              });
            }
            
            function restartServer() {
              // Show notification
              showNotification({
                title: 'Sunucu Yeniden Başlatılıyor',
                message: 'Sunucu yeniden başlatılıyor, lütfen bekleyin...',
                type: 'info'
              });
              
              // API'ye istek gönder
              fetch(`${API_URL}/api/admin/restart`, {
                method: 'POST',
                headers: {
                  'Authorization': `Bearer ${localStorage.getItem('token')}`
                }
              })
              .then(response => {
                if (!response.ok) {
                  throw new Error('Restart server error');
                }
                return response.json();
              })
              .then(data => {
                // Show notification
                showNotification({
                  title: 'Başarılı',
                  message: 'Sunucu başarıyla yeniden başlatıldı.',
                  type: 'success'
                });
                
                // Add to logs
                addSystemLog('INFO', 'Sunucu yeniden başlatıldı');
              })
              .catch(error => {
                console.error('Restart server error:', error);
                showNotification({
                  title: 'Hata',
                  message: 'Sunucu yeniden başlatılırken bir hata oluştu.',
                  type: 'error'
                });
              });
            }
            
            function addSystemLog(level, message) {
              const systemLogs = document.getElementById('system-logs');
              
              // Create log element
              const logElement = document.createElement('div');
              logElement.style.marginBottom = '5px';
              
              // Format log level
              let levelClass = '';
              if (level === 'ERROR') {
                levelClass = 'color: #ef4444;';
              } else if (level === 'WARNING') {
                levelClass = 'color: #f59e0b;';
              } else if (level === 'INFO') {
                levelClass = 'color: #3b82f6;';
              }
              
              // Format log
              logElement.innerHTML = `
                <span style="color: #aaa;">[${new Date().toLocaleString('tr-TR')}]</span>
                <span style="${levelClass}">[${level}]</span>
                <span>${message}</span>
              `;
              
              // Add to logs
              systemLogs.appendChild(logElement);
              
              // Scroll to bottom
              systemLogs.scrollTop = systemLogs.scrollHeight;
            }
            
            // ===== UTILITY FUNCTIONS =====
            function closeModal(modalId) {
              document.getElementById(modalId).classList.remove('show');
            }
            
            function showNotification(options) {
              const container = document.getElementById('notifications');
              
              // Create notification element
              const notification = document.createElement('div');
              notification.className = 'notification';
              notification.style.backgroundColor = '#fff';
              notification.style.borderRadius = '8px';
              notification.style.boxShadow = '0 2px 4px rgba(0, 0, 0, 0.1)';
              notification.style.marginBottom = '10px';
              notification.style.overflow = 'hidden';
              notification.style.transition = 'all 0.3s ease';
              notification.style.animation = 'slideIn 0.3s ease-out';
    
    // Set notification type color
    let typeColor = '#3b82f6'; // Default blue
    let typeIcon = 'fa-info-circle';
    
    if (options.type === 'success') {
      typeColor = '#10b981';
      typeIcon = 'fa-check-circle';
    } else if (options.type === 'error') {
      typeColor = '#ef4444';
      typeIcon = 'fa-exclamation-circle';
    } else if (options.type === 'warning') {
      typeColor = '#f59e0b';
      typeIcon = 'fa-exclamation-triangle';
    }
    
    // Create notification content
    notification.innerHTML = `
      <div class="notification-header" style="padding: 12px 15px; display: flex; align-items: center; justify-content: space-between; border-bottom: 1px solid #eee;">
        <div class="notification-title" style="font-weight: 600; font-size: 14px; display: flex; align-items: center; gap: 8px;">
          <i class="fas ${typeIcon}" style="color: ${typeColor};"></i>
          ${options.title}
        </div>
        <button class="notification-close" style="background: none; border: none; font-size: 16px; cursor: pointer; color: #666;" onclick="this.parentElement.parentElement.remove()">
          <i class="fas fa-times"></i>
        </button>
      </div>
      <div class="notification-body" style="padding: 12px 15px; font-size: 14px; line-height: 1.5;">
        ${options.message}
      </div>
    `;
    
    // Add notification to container
    container.appendChild(notification);
    
    // Remove notification after 5 seconds
    setTimeout(() => {
      notification.style.opacity = '0';
      notification.style.transform = 'translateX(100%)';
      
      setTimeout(() => {
        notification.remove();
      }, 300);
    }, 5000);
  }
  
  // API URL
  const API_URL = 'https://api.ebfl.ai';
</script>

<div id="notifications" class="notification-container"></div>

<!-- Login Modal -->
<div class="modal" id="login-modal">
  <div class="modal-content">
    <div class="modal-header">
      <h2>Giriş Yap</h2>
      <button class="close-btn" onclick="closeModal('login-modal')">&times;</button>
    </div>
    <div class="modal-body">
      <div class="form-group">
        <label for="login-email">E-posta</label>
        <input type="email" id="login-email" class="form-control" placeholder="E-posta adresiniz">
      </div>
      <div class="form-group">
        <label for="login-password">Şifre</label>
        <div class="password-input">
          <input type="password" id="login-password" class="form-control" placeholder="Şifreniz">
          <button type="button" class="password-toggle" onclick="togglePasswordVisibility('login-password')">
            <i class="fas fa-eye" id="login-password-toggle"></i>
          </button>
        </div>
      </div>
      <div class="form-group">
        <a href="#" onclick="showForgotPasswordModal()">Şifremi unuttum</a>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-primary" onclick="login()">Giriş Yap</button>
      <button class="btn btn-secondary" onclick="closeModal('login-modal')">İptal</button>
    </div>
  </div>
</div>

<!-- Register Modal -->
<div class="modal" id="register-modal">
  <div class="modal-content">
    <div class="modal-header">
      <h2>Kayıt Ol</h2>
      <button class="close-btn" onclick="closeModal('register-modal')">&times;</button>
    </div>
    <div class="modal-body">
      <div class="form-row">
        <div class="form-group">
          <label for="register-name">Ad</label>
          <input type="text" id="register-name" class="form-control" placeholder="Adınız">
        </div>
        <div class="form-group">
          <label for="register-surname">Soyad</label>
          <input type="text" id="register-surname" class="form-control" placeholder="Soyadınız">
        </div>
      </div>
      <div class="form-group">
        <label for="register-email">E-posta</label>
        <input type="email" id="register-email" class="form-control" placeholder="E-posta adresiniz">
      </div>
      <div class="form-group">
        <label for="register-password">Şifre</label>
        <div class="password-input">
          <input type="password" id="register-password" class="form-control" placeholder="Şifreniz" onkeyup="checkPasswordStrength()">
          <button type="button" class="password-toggle" onclick="togglePasswordVisibility('register-password')">
            <i class="fas fa-eye" id="register-password-toggle"></i>
          </button>
        </div>
        <div id="password-strength">
          <div id="password-strength-bar">
            <div></div>
          </div>
          <span>Zayıf</span>
        </div>
      </div>
      <div class="form-group">
        <label for="register-password-confirm">Şifre Tekrar</label>
        <div class="password-input">
          <input type="password" id="register-password-confirm" class="form-control" placeholder="Şifrenizi tekrar girin">
          <button type="button" class="password-toggle" onclick="togglePasswordVisibility('register-password-confirm')">
            <i class="fas fa-eye" id="register-password-confirm-toggle"></i>
          </button>
        </div>
      </div>
      <div class="form-group">
        <div class="checkbox-group">
          <input type="checkbox" id="terms-checkbox">
          <label for="terms-checkbox">
            <a href="#" target="_blank">Kullanım şartlarını</a> ve <a href="#" target="_blank">gizlilik politikasını</a> kabul ediyorum.
          </label>
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-primary" onclick="register()">Kayıt Ol</button>
      <button class="btn btn-secondary" onclick="closeModal('register-modal')">İptal</button>
    </div>
  </div>
</div>

<!-- Forgot Password Modal -->
<div class="modal" id="forgot-password-modal">
  <div class="modal-content">
    <div class="modal-header">
      <h2>Şifremi Unuttum</h2>
      <button class="close-btn" onclick="closeModal('forgot-password-modal')">&times;</button>
    </div>
    <div class="modal-body">
      <div class="form-group">
        <label for="forgot-email">E-posta</label>
        <input type="email" id="forgot-email" class="form-control" placeholder="E-posta adresiniz">
      </div>
      <p class="form-info">
        Şifre sıfırlama bağlantısı e-posta adresinize gönderilecektir.
      </p>
    </div>
    <div class="modal-footer">
      <button class="btn btn-primary" onclick="resetPassword()">Şifremi Sıfırla</button>
      <button class="btn btn-secondary" onclick="closeModal('forgot-password-modal')">İptal</button>
    </div>
  </div>
</div>

<!-- Add Task Modal -->
<div class="modal" id="add-task-modal">
  <div class="modal-content">
    <div class="modal-header">
      <h2>Ders Ekle</h2>
      <button class="close-btn" onclick="closeModal('add-task-modal')">&times;</button>
    </div>
    <div class="modal-body">
      <div class="form-group">
        <label for="task-title">Ders Adı</label>
        <input type="text" id="task-title" class="form-control" placeholder="Ders adı">
      </div>
      <div class="form-group">
        <label for="task-subject">Konu</label>
        <select id="task-subject" class="form-control">
          <option value="math">Matematik</option>
          <option value="physics">Fizik</option>
          <option value="chemistry">Kimya</option>
          <option value="biology">Biyoloji</option>
          <option value="turkish">Türkçe</option>
          <option value="english">İngilizce</option>
          <option value="history">Tarih</option>
          <option value="geography">Coğrafya</option>
          <option value="other">Diğer</option>
        </select>
      </div>
      <div class="form-row">
        <div class="form-group">
          <label for="task-day">Gün</label>
          <select id="task-day" class="form-control">
            <option value="1">Pazartesi</option>
            <option value="2">Salı</option>
            <option value="3">Çarşamba</option>
            <option value="4">Perşembe</option>
            <option value="5">Cuma</option>
            <option value="6">Cumartesi</option>
            <option value="7">Pazar</option>
          </select>
        </div>
        <div class="form-group">
          <label for="task-hour">Saat</label>
          <select id="task-hour" class="form-control">
            <option value="8">08:00</option>
            <option value="9">09:00</option>
            <option value="10">10:00</option>
            <option value="11">11:00</option>
            <option value="12">12:00</option>
            <option value="13">13:00</option>
            <option value="14">14:00</option>
            <option value="15">15:00</option>
            <option value="16">16:00</option>
            <option value="17">17:00</option>
            <option value="18">18:00</option>
            <option value="19">19:00</option>
            <option value="20">20:00</option>
          </select>
        </div>
        <div class="form-group">
          <label for="task-duration">Süre (saat)</label>
          <select id="task-duration" class="form-control">
            <option value="1">1</option>
            <option value="2">2</option>
            <option value="3">3</option>
            <option value="4">4</option>
          </select>
        </div>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-primary" onclick="addTask()">Ekle</button>
      <button class="btn btn-secondary" onclick="closeModal('add-task-modal')">İptal</button>
    </div>
  </div>
</div>

<!-- New Planner Modal -->
<div class="modal" id="new-planner-modal">
  <div class="modal-content">
    <div class="modal-header">
      <h2>Yeni Ders Programı</h2>
      <button class="close-btn" onclick="closeModal('new-planner-modal')">&times;</button>
    </div>
    <div class="modal-body">
      <div class="form-group">
        <label for="planner-name">Program Adı</label>
        <input type="text" id="planner-name" class="form-control" placeholder="Program adı">
      </div>
      <div class="form-group">
        <label for="planner-description">Açıklama</label>
        <textarea id="planner-description" class="form-control" placeholder="Açıklama (isteğe bağlı)"></textarea>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn btn-primary" onclick="createNewPlanner()">Oluştur</button>
      <button class="btn btn-secondary" onclick="closeModal('new-planner-modal')">İptal</button>
    </div>
  </div>
</div>
</body>
</html>